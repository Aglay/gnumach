2002-04-23  Roland McGrath  <roland@frob.com>

	* i386/i386/ldt.c (ldt_init): Fix fencepost error in segment limits.

2002-04-19  Roland McGrath  <roland@frob.com>

	* gensym.awk: Emit \n\ at the end of lines inside strings.
	* Makefile.in (%.symc: %.sym): Depend on gensym.awk.

2002-03-05  Roland McGrath  <roland@frob.com>

	* kern/bootstrap.c: Include <alloca.h>.

2002-03-04  Roland McGrath  <roland@frob.com>

	* Makefile.in (%_interface.h %_server.c: %.srv): Pass -sheader switch
	to mig, not -header.

2001-10-13  Marcus Brinkmann  <marcus@gnu.org>

	* debian/changelog: Update for next release.

2001-10-07  Roland McGrath  <roland@frob.com>

	* ddb/db_access.c: Fix obsolescent #else/#endif syntax.
	* device/dev_name.c: Likewise.
	* device/dev_pager.c: Likewise.
	* device/ds_routines.c: Likewise.
	* i386/i386/i386asm.sym: Likewise.
	* include/device/device_reply.defs: Likewise.
	* include/mach/memory_object.defs: Likewise.
	* include/mach/memory_object_default.defs: Likewise.

	* i386/i386/locore.S: Fix sloppy asm syntax to avoid warnings from
	newer assembler (%ecx -> %cl in byte insns).

	* kern/bootstrap.c (bootstrap_create): Fix inverted test logic for
	compatibility case.  Ignore trailing newlines after space for
	compatibility detection.
	Reported by Neal H Walfield <neal@cs.uml.edu>.

2001-10-06  Marcus Brinkmann  <marcus@gnu.org>

	* README: Replace `GNU mach' by `GNU Mach', and remove
	obsolete paragraph about kmsg device.

2001-10-06  Marcus Brinkmann  <marcus@gnu.org>

	* doc/mach.texi: Fix direntry.

2001-10-05  Marcus Brinkmann  <marcus@gnu.org>

	* doc/mach.texi: Replace `path name' by `file name' in one place.
	Replace `illegal' by `invalid' and `to to' by `to' everwhere.

	* debian/changelog: Prepare for next release.

2001-10-04  Marcus Brinkmann  <marcus@gnu.org>

	* doc: New directory.
	* doc/Makefile.in: New file.
	* doc/gpl.texi: Likewise.
	* doc/fdl.texi: Likewise.
	* doc/mach.texi: Likewise.
	* configure.in: Add doc/Makefile to AC_OUTPUT call.
	* configure: Regenerated.

	* Makefile.in (dist): Create directories doc and debian.
	(doc-files): New variable with documentation files.
	(debian-files): New variable with Debian packaging files.

	* debian/rules (stamp-build): Build documentation.
	(build-gnumach): Install the documentation into the gnumach
	package.
	* debian/postrm: New file to install info document.
	* debian/prerm: New file to install info document.

2001-10-01  Marcus Brinkmann  <marcus@gnu.org>

	* i386/i386/locore.S (tenmicrosec): Remove subroutine.
	* i386/i386/pit.c (delaycount): Remove global variable.
	(microdata): Likewise.
	(clkstart): Do not call findspeed() and microfind().
	(findspeed): Remove function.
	(spinwait): Likewise.
	(microfind): Likewise.  This function triggers a division by zero
	trap on AMD K6 350Mhz+ and Athlon 1.1GHz+ machines (and in general
	leads to bad results on fast cpus), and nothing uses this code anymore.

2001-09-30  Roland McGrath  <roland@frob.com>

	* kern/bootstrap.c (bootstrap_create): Ignore trailing spaces when
	checking boot module string for containing none.

2001-09-18  Marcus Brinkmann  <marcus@gnu.org>

	* linux/dev/glue/misc.c: Do not include <linux/types.h> and
	<linux/string.h>.
	Remove global variable ___strtok.
	Remove implementation of strspn, strpbrk, strtok and strstr.
	* Makefile.in: Add strpbrk and strtok.

2001-08-24  Roland McGrath  <roland@frob.com>

	* kern/bootstrap.c (bootstrap_create): Make setting of boot-args and
	root-device no longer conditional on [! OSKIT_MACH].
	(bootstrap_create) [! OSKIT_MACH]: Parse FOO=BAR words out of the
	multiboot command line and turn those into boot script variables.

	* Makefile.in (clib-routines): Add strsep.
	* kern/strings.h (strsep, strchr): Declare them.

2001-08-23  Roland McGrath  <roland@frob.com>

	* kern/bootstrap.c (bootstrap_create, user_bootstrap,
	boot_script_exec_cmd, boot_script_task_resume): Add printfs at
	various stages of startup.

2001-08-21  Roland McGrath  <roland@frob.com>

	* i386/i386at/model_dep.c (use_all_mem): Turn variable into macro.
	(init_alloc_aligned): Make this function static.
	Initially skip memory < 16MB and then wrap around to get it last.

2001-08-20  Roland McGrath  <roland@frob.com>

	Support "boot script" functionality in multiboot module strings.
	* kern/bootstrap.c: Rewrite merged from oskit-branch.
	* kern/boot_script.c, kern/boot_script.h: New files,
	copied from boot/ directory in Hurd sources.
	* Makefile.in (kern-cfiles): Add boot_script.c here.
	(kern-files): Add boot_script.h here.
	* NEWS: Mention the new feature.

2001-08-18  Roland McGrath  <roland@frob.com>

	* i386/i386at/model_dep.c (boot_info): Define a struct, not a pointer.
	(c_boot_entry): Copy the contents into it rather than setting the ptr.
	(c_boot_entry, init_alloc_aligned, pmap_valid_page, mem_size_init):
	Update uses.
	(init_alloc_aligned): Don't need to skip the boot_info memory.
	* kern/bootstrap.c (boot_info): Update decl.
	(bootstrap_create): Update uses.

2001-08-18  Marcus Brinkmann  <marcus@gnu.org>

	* linux/src/drivers/net/eepro100.c: File updated to version in
	Linux 2.2.19.  This time for real.

2001-08-18  Marcus Brinkmann  <marcus@gnu.org>

	* debian/changelog: Update for next package upload.
	* debian/control: Add gnumach-dbg package.
	* debian/rules: New targets to build gnumach-dbg package.
	Fix various bugs.

2001-08-18  Marcus Brinkmann  <marcus@gnu.org>

	* i386/i386at/kd.c (kdintr): In event mode, make it so that
	0xE0 scancodes are received.
	From Kalle Olavi Niemitalo <tosi@ees2.oulu.fi>.

	* i386/i386at/kd.h: New constants KAX_REVERSE, KAX_UNDERLINE,
	KAX_BLINK, KAX_BOLD, KAX_DIM, KAX_INVISIBLE, KAX_COL_UNDERLINE,
	KAX_COL_DIM.
	* i386/i386at/kd.c: Increase K_MAXESC to 32.
	New global variable color_table to map color values.
	New globals kd_color and kd_attrflags.
	(kdinit): Initialize these variables.
	(kd_update_kd_attr): New function.
	(kd_parserest): Redone to support more terminal attributes,
	including colors.

2001-08-18  Marcus Brinkmann  <marcus@gnu.org>

	* linux/src/drivers/net/eepro100.c: File updated to version in
	Linux 2.2.19.
	* linux/src/include/asm-i386/spinlock.h: New file from Linux 2.2.19.
	* linux/src/include/asm-i386/hardirq.h: Likewise.
	* linux/src/include/linux/spinlock.h: Likewise.
	* linux/src/include/linux/compatmac.h: Likewise.
        * linux/dev/drivers/net/eepro100.c: New file, modified version from
        the above to glue it in gnumach.
        Submitted by Kapil H. Paranjape <kapil@imsc.ernet.in>.

2001-08-17  Roland McGrath  <roland@frob.com>

	* Makefile.in (clib-routines): Add strchr.
	(kernel-undef-bad): Depend on Makefile.

	* Makefile.in ($(srcdir)/configure, $(srcdir)/config.h.in):
	Use $(srcdir) in deps.
	(Makefile, config.h, config.status): Likewise.

2001-07-29  Marcus Brinkmann  <marcus@gnu.org>

	* NEWS: Add items for this and other changes.
	* configure.in: Define MACH_KMSG by default and document this in
	the help output.
	* configure: Regenerated.
	* debian/rules: Do not enable kmsg explicitely.

2001-07-18  Marcus Brinkmann  <marcus@gnu.org>

	* debian/rules: Add -isp to dpkg-gencontrol invocation.
	Move documentation to /share/doc.
	* debian/changelog: Update.

2001-06-28  Marcus Brinkmann  <marcus@gnu.org>

	* linux/dev/drivers/block/ide.c (lba_capacity_is_ok): Do not
	attempt to correct id->cyls, it is a short and for large disks the
	number of cylinders necessary would not fit.  Subsequent checks
	for lba support would fail.
	(current_capacity): Likewise for drive->cyl.
	(do_identify): Store value returned by current_capacity in
	CAPACITY.  The check which corrects the number of bios cylinders
	is not aggressive enough.  Update it with the check in linux
	kernel-2.2.19.

2001-06-25  Marcus Brinkmann  <marcus@gnu.org>

	* i386/bogus/fpe.h (FPE): Define FPE to 0, as the floating point
	emulation is broken anyway and blows up plex86.

2001-06-17  Marcus Brinkmann  <marcus@gnu.org>

	* debian/rules: Update to current version.

2001-06-13  Roland McGrath  <roland@frob.com>

	* linux/dev/glue/block.c (device_get_status: DEV_GET_RECORDS):
	Always return 512 for DEV_GET_SIZE_RECORD_SIZE as DEV_GET_SIZE does.

2001-05-27  Marcus Brinkmann  <marcus@gnu.org>

	* debian/rules: Add --enable-ncr53c8xx to configure.

1999-10-06  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linux/src/drivers/scsi/tmscsiw.c: Removed.
	* linux/src/drivers/scsi/tmscsiw.h: Likewise.
	* linux/src/drivers/scsi/dc390w.h: Likewise.
	* i386/linux/device-drivers.h.in (CONFIG_SCSI_DC390W): Deleted.
	* i386/linux/Drivers.in: Remove linux_DRIVER(dc390w, ...). Now
	dc390w, dc390u, and dc390f are aliases to ncr53c8xx.
	* i386/linux/configure: Regenerated.
	* linux/Files: Likewise.
	* i386/linux/Makefile.in (linux-scsi-files): Delete tmscsiw.c.
	* linux/dev/drivers/scsi/hosts.c: Do not include dc390w.h.
	Reported by Andreas Voegele <andreas.voegele@nikocity.de>.

2001-05-20  Roland McGrath  <roland@frob.com>

	* kern/sched_prim.c (state_panic): New function, panic with some
	info when a thread's state is bogus.
	(thread_wakeup_prim): Use that instead of uninformative panic.
	(thread_invoke): Likewise.
	(thread_dispatch): Likewise.

2001-05-12  Marcus Brinkmann  <marcus@gnu.org>

	* ipc/ipc_object.c (ipc_object_alloc): Remove initialization of
	*namep, which was without effect.

2001-04-29  Marcus Brinkmann  <marcus@gnu.org>

	* debian/changelog: New entries for past Debian uploads.
	* debian/rules: Disable eatdma driver (breaks AMD K7), do
	not enable com, lpr (com is redundant, lpr doesn't work),
	move enabling of kmsg in its own line.
	* debian/control: Add build dependency on mig and sharutils.

2001-04-29  Marcus Brinkmann  <marcus@gnu.org>

	* device/chario.c: Set number of elements of tthiwat and ttlowat
	to NSPEEDS rather than 16. Initialize the two new elements.
	(chario_init): Initialize pdma_timeouts and pdma_water_mark for
	B57600 and B115200.

2001-04-27  Marcus Brinkmann  <marcus@gnu.org>

	* include/device/tty_status.h: New macros B57600 and B115200,
	increase NSPEED accordingly.
	* i386/i386at/com.c (divisorreg): New divisor 1.

2001-04-04  Roland McGrath  <roland@frob.com>

	* ddb/db_access.h: Fix obsolescent #else/#endif syntax.
	* ddb/db_aout.c: Likewise.
	* ddb/db_break.c: Likewise.
	* ddb/db_break.h: Likewise.
	* ddb/db_command.c: Likewise.
	* ddb/db_command.h: Likewise.
	* ddb/db_cond.c: Likewise.
	* ddb/db_examine.c: Likewise.
	* ddb/db_expr.c: Likewise.
	* ddb/db_ext_symtab.c: Likewise.
	* ddb/db_input.c: Likewise.
	* ddb/db_lex.c: Likewise.
	* ddb/db_macro.c: Likewise.
	* ddb/db_mp.c: Likewise.
	* ddb/db_output.c: Likewise.
	* ddb/db_print.c: Likewise.
	* ddb/db_run.c: Likewise.
	* ddb/db_sym.c: Likewise.
	* ddb/db_task_thread.c: Likewise.
	* ddb/db_task_thread.h: Likewise.
	* ddb/db_trap.c: Likewise.
	* ddb/db_variables.c: Likewise.
	* ddb/db_watch.c: Likewise.
	* ddb/db_watch.h: Likewise.
	* ddb/db_write_cmd.c: Likewise.
	* device/dev_pager.c: Likewise.
	* device/device_port.h: Likewise.
	* device/device_types_kernel.h: Likewise.
	* device/ds_routines.h: Likewise.
	* device/errno.h: Likewise.
	* device/if_ether.h: Likewise.
	* device/if_hdr.h: Likewise.
	* device/io_req.h: Likewise.
	* device/net_io.c: Likewise.
	* device/net_io.h: Likewise.
	* i386/i386/ast_check.c: Likewise.
	* i386/i386/cswitch.S: Likewise.
	* i386/i386/db_disasm.c: Likewise.
	* i386/i386/db_interface.c: Likewise.
	* i386/i386/db_trace.c: Likewise.
	* i386/i386/debug.h: Likewise.
	* i386/i386/debug_i386.c: Likewise.
	* i386/i386/debug_trace.S: Likewise.
	* i386/i386/eflags.h: Likewise.
	* i386/i386/gdt.h: Likewise.
	* i386/i386/hardclock.c: Likewise.
	* i386/i386/idt-gen.h: Likewise.
	* i386/i386/ipl.h: Likewise.
	* i386/i386/ktss.h: Likewise.
	* i386/i386/kttd_interface.c: Likewise.
	* i386/i386/ldt.h: Likewise.
	* i386/i386/lock.h: Likewise.
	* i386/i386/locore.S: Likewise.
	* i386/i386/mp_desc.h: Likewise.
	* i386/i386/pic.c: Likewise.
	* i386/i386/pic.h: Likewise.
	* i386/i386/pio.h: Likewise.
	* i386/i386/pit.h: Likewise.
	* i386/i386/seg.h: Likewise.
	* i386/i386/thread.h: Likewise.
	* i386/i386/trap.c: Likewise.
	* i386/i386/trap.h: Likewise.
	* i386/i386/vm_param.h: Likewise.
	* i386/i386/vm_tuning.h: Likewise.
	* i386/i386at/autoconf.c: Likewise.
	* i386/i386at/blit.c: Likewise.
	* i386/i386at/conf.c: Likewise.
	* i386/i386at/fd.c: Likewise.
	* i386/i386at/idt.h: Likewise.
	* i386/i386at/immc.c: Likewise.
	* i386/i386at/kd.c: Likewise.
	* i386/i386at/kd_event.c: Likewise.
	* i386/i386at/kd_mouse.c: Likewise.
	* i386/i386at/model_dep.c: Likewise.
	* i386/i386at/rtc.c: Likewise.
	* i386/include/mach/i386/asm.h: Likewise.
	* i386/include/mach/i386/eflags.h: Likewise.
	* i386/include/mach/i386/mach_i386.defs: Likewise.
	* i386/include/mach/i386/multiboot.h: Likewise.
	* i386/include/mach/i386/trap.h: Likewise.
	* i386/include/mach/i386/vm_types.h: Likewise.
	* i386/include/mach/sa/stdarg.h: Likewise.
	* i386/intel/pmap.c: Likewise.
	* i386/intel/pmap.h: Likewise.
	* include/alloca.h: Likewise.
	* include/device/device_types.defs: Likewise.
	* include/device/device_types.h: Likewise.
	* include/device/disk_status.h: Likewise.
	* include/device/net_status.h: Likewise.
	* include/mach/mach.defs: Likewise.
	* include/mach/memory_object.defs: Likewise.
	* include/mach/std_types.defs: Likewise.
	* include/mach_debug/hash_info.h: Likewise.
	* include/mach_debug/ipc_info.h: Likewise.
	* include/mach_debug/mach_debug.defs: Likewise.
	* include/mach_debug/mach_debug_types.defs: Likewise.
	* include/mach_debug/mach_debug_types.h: Likewise.
	* include/mach_debug/vm_info.h: Likewise.
	* include/mach_debug/zone_info.h: Likewise.
	* include/sys/ioctl.h: Likewise.
	* include/sys/time.h: Likewise.
	* ipc/ipc_entry.h: Likewise.
	* ipc/ipc_hash.h: Likewise.
	* ipc/ipc_init.c: Likewise.
	* ipc/ipc_kmsg.c: Likewise.
	* ipc/ipc_kmsg.h: Likewise.
	* ipc/ipc_marequest.c: Likewise.
	* ipc/ipc_marequest.h: Likewise.
	* ipc/ipc_mqueue.c: Likewise.
	* ipc/ipc_mqueue.h: Likewise.
	* ipc/ipc_notify.c: Likewise.
	* ipc/ipc_notify.h: Likewise.
	* ipc/ipc_object.c: Likewise.
	* ipc/ipc_object.h: Likewise.
	* ipc/ipc_port.c: Likewise.
	* ipc/ipc_port.h: Likewise.
	* ipc/ipc_pset.c: Likewise.
	* ipc/ipc_pset.h: Likewise.
	* ipc/ipc_right.c: Likewise.
	* ipc/ipc_right.h: Likewise.
	* ipc/ipc_space.c: Likewise.
	* ipc/ipc_space.h: Likewise.
	* ipc/mach_debug.c: Likewise.
	* ipc/mach_msg.c: Likewise.
	* ipc/mach_msg.h: Likewise.
	* ipc/mach_port.c: Likewise.
	* kern/act.c: Likewise.
	* kern/assert.h: Likewise.
	* kern/ast.c: Likewise.
	* kern/ast.h: Likewise.
	* kern/bootstrap.c: Likewise.
	* kern/counters.c: Likewise.
	* kern/counters.h: Likewise.
	* kern/debug.h: Likewise.
	* kern/exception.c: Likewise.
	* kern/host.h: Likewise.
	* kern/ipc_host.c: Likewise.
	* kern/ipc_host.h: Likewise.
	* kern/ipc_kobject.c: Likewise.
	* kern/ipc_mig.c: Likewise.
	* kern/ipc_tt.c: Likewise.
	* kern/ipc_tt.h: Likewise.
	* kern/kalloc.h: Likewise.
	* kern/lock_mon.c: Likewise.
	* kern/mach_clock.c: Likewise.
	* kern/mach_factor.c: Likewise.
	* kern/mach_param.h: Likewise.
	* kern/machine.c: Likewise.
	* kern/processor.c: Likewise.
	* kern/profile.c: Likewise.
	* kern/queue.h: Likewise.
	* kern/sched.h: Likewise.
	* kern/startup.c: Likewise.
	* kern/syscall_emulation.h: Likewise.
	* kern/syscall_subr.c: Likewise.
	* kern/syscall_subr.h: Likewise.
	* kern/syscall_sw.c: Likewise.
	* kern/syscall_sw.h: Likewise.
	* kern/task.h: Likewise.
	* kern/thread_swap.h: Likewise.
	* kern/time_out.h: Likewise.
	* kern/time_stamp.c: Likewise.
	* kern/time_stamp.h: Likewise.
	* kern/timer.c: Likewise.
	* kern/timer.h: Likewise.
	* kern/xpr.c: Likewise.
	* kern/xpr.h: Likewise.
	* kern/zalloc.c: Likewise.
	* kern/zalloc.h: Likewise.
	* linux/dev/drivers/block/ide.c: Likewise.
	* linux/dev/include/linux/blk.h: Likewise.
	* linux/src/include/linux/cdrom.h: Likewise.
	* linux/src/include/linux/md.h: Likewise.
	* util/cpu.h: Likewise.
	* vm/memory_object.c: Likewise.
	* vm/memory_object.h: Likewise.
	* vm/pmap.h: Likewise.
	* vm/vm_debug.c: Likewise.
	* vm/vm_external.h: Likewise.
	* vm/vm_fault.c: Likewise.
	* vm/vm_fault.h: Likewise.
	* vm/vm_kern.h: Likewise.
	* vm/vm_map.c: Likewise.
	* vm/vm_map.h: Likewise.
	* vm/vm_object.h: Likewise.
	* vm/vm_pageout.c: Likewise.
	* vm/vm_pageout.h: Likewise.
	* vm/vm_user.h: Likewise.

2001-01-28  Roland McGrath  <roland@frob.com>

	* kern/zalloc.c (zalloc): Change panics for exhausted zone to include
	the zone name.

2001-01-09  Marcus Brinkmann  <marcus@gnu.org>

	* include/device/device_types.h: New get_status call
	DEV_GET_RECORDS to get the number of records of a device (rather
	than the number of bytes). Accordingly define
	DEV_GET_RECORDS_DEVICE_RECORDS, DEV_GET_RECORDS_RECORD_SIZE and
	DEV_GET_RECORDS_COUNT.

	* linux/dev/glue/block.c (device_get_status): Handle
	DEV_GET_RECORDS.

2000-11-26  David Welch  <david.welch@seh.ox.ac.uk>

	* i386/Makefrag (i386-installed-headers): Removed dead files
	from the list of headers to be installed

2000-11-26  Marcus Brinkmann  <marcus@gnu.org>

	* linux/src/drivers/net/tulip.c: Updated to version
	from Linux 2.2.17 (I am amazed that 2.2.x drivers work).
	Suggested by Jason Henry Parker <jasonp@uq.net.au>.

2000-10-29  Roland McGrath  <roland@frob.com>

	Remove numerous dead header files.
	Suggested by Igor Khavkine <i_khavki@alcor.concordia.ca>.
	* i386/include/mach/i386/bios.h: Dead file removed.
	* i386/include/mach/i386/code16.h: Dead file removed.
	* i386/include/mach/i386/debug_reg.h: Dead file removed.
	* i386/include/mach/i386/dpmi.h: Dead file removed.
	* i386/include/mach/i386/far_ptr.h: Dead file removed.
	* i386/include/mach/i386/paging.h: Dead file removed.
	* i386/include/mach/i386/pio.h: Dead file removed.
	* i386/include/mach/i386/pmode.h: Dead file removed.
	* i386/include/mach/i386/proc_reg.h: Dead file removed.
	* i386/include/mach/i386/seg.h: Dead file removed.
	* i386/include/mach/i386/time_stamp.h: Dead file removed.
	* i386/include/mach/i386/tss.h: Dead file removed.
	* i386/include/mach/i386/vcpi.h: Dead file removed.
	* i386/include/mach/proc_ops.h: Dead file removed.
	* i386/include/mach/sa/sys/varargs.h: Dead file removed.
	* i386/include/mach/setjmp.h: Dead file removed.
	* include/mach/proc_ops.h: Dead file removed.
	* Makefile.in (mach-headers): Remove proc_ops.h.
	* i386/Makefrag (i386-installed-headers): Likewise.
	(installed-headers): Don't touch this any more.
	* i386/Files: Update for removed files.

2000-09-29  Marcus Brinkmann  <marcus@gnu.org>

	* i386/i386at/conf.c (dev_name_list): Don't use MACH_COM to check
	if com support is enabled, but NCOM, as it used to be.

2000-09-24  OKUJI Yoshinori  <okuji@gnu.org>

	* linux/dev/glue/block.c: Reverted the changes at 2000-08-17.
	Reported by Brent Fulgham <brent.fulgham@xpsystems.com>.

2000-09-19  Marcus Brinkmann  <marcus@gnu.org>

	* linux/dev/glue/block.c (init_partition): Move initialization
	of MASK until it is asserted that gd is non-NULL.

2000-08-17  OKUJI Yoshinori  <okuji@gnu.org>

	* linux/dev/glue/block.c (rdwr_partial): Mask the minor device
	number with MINOR_SHIFT bits, when indexing the array of
	partitions. Reported by Marius Vollmer <mvo@zagadka.ping.de>.
	(init_partition): Likewise.
	(check_limit): Likewise.
	(device_get_status): Likewise.

2000-07-27  Marcus Brinkmann  <marcus@gnu.org>

	* Fix omissions in last change:
	* linux/src/arch/i386/lib/delay.S: Now really delete the file.
	* linux/src/arch/i386/lib/delay.c: Now really add the file.

2000-07-04  Marcus Brinkmann <marcus@gnu.org>

	* debian/changelog: Add entry for new Debian upload.
        * linux/dev/drivers/scsi/seagate.c (WRITE_CONTROL, WRITE_DATA):
        Added from linux 2.2.15.
        (__asm__ constructs): Replace with equivalent C code from linux 2.2.15
        to support gcc-2.95.
        * linux/src/drivers/scsi/in2000.h: Update asm code to linux 2.2.15.
	* linux/src/drivers/scsi/ppa.c: Replace asm code with equivalent
	C code from linux 2.2.15.

2000-02-06  Stefan Weil <stefan.weil@de.heidelberg.com>

	* device/subrs.c: Fixed compiler warning.
	* ddb/db_output.c, kern/bootstrap.c, kern/debug.c, kern/printf.c:
	Replaced varargs.h by stdarg.h. Fixed prototypes (const char *fmt).
	* ddb/db_output.h: Use prototype for db_printf.
	* i386/Files: removed varargs.h.
	* i386/i386/pit.h: Fixed compiler warning.
	* i386/i386at/model_dep.c: Tried to fix compiler warning.
	* i386/include/mach/sa/sys/varargs.h: Removed.
	* i386/linux/Makefile.in: Removed delay.S, added delay.c.
	* linux/dev/include/asm-i386/segment.h: Support gcc-2.95.
	* linux/dev/include/asm-i386/string.h,
	linux/src/include/asm-i386/string.h: Update from linux-2.2.14.
	* linux/dev/lib/vsprintf.c: Fixed compiler warning.
	* linux/src/include/asm-i386/delay.h: Update from linux-2.2.14.
	* linux/src/arch/i386/lib/delay.c: Copy from linux-2.2.14.
	* linux/src/include/asm-i386/string.h: Update from linux-2.2.14.

1999-10-08  Thomas Bushnell, BSG  <tb@mit.edu>

	* linux/src/drivers/net/3c59x.c: Updated to version 0.99L of the
	driver from ftp://cesdis.gsfc.nasa.gov/linux/drivers/3c59x.c, in
	order to support the 3c509c card, as requested by Jeff Bailey
	<jbailey@nisa.net>.

1999-09-17  Thomas Bushnell, BSG  <tb@mit.edu>

	* linux/dev/drivers/block/ide.c (do_request) [MACH]: In "bad
	access" printf, actually print the number of sectors of the
	partition.

1999-10-05  Roland McGrath  <roland@baalperazim.frob.com>

	* i386/intel/pmap.c (pmap_bootstrap): Use _start instead of start.
	* i386/i386/trap.c (kernel_trap): Likewise.

1999-10-04  Roland McGrath  <roland@baalperazim.frob.com>

	* configure.in: Remove AC_CHECK_TOOL(MAKE,...) check.
	* Makefile.in (MAKE): Variable removed.  We require GNU make anyway,
	and it always sets MAKE.
	* configure: Regenerated.

	* Makefile.in (clib-routines.o, check-clib-routines, clib-routines.d):
	Remove these rules, replace with:
	(kernel.o): New target, relocatable object linked from kernel objects.
	(kernel-undef, kernel-undef-bad): New targets, glean undefined symbols
	from kernel.o.
	(clib-routines.o): New target, use those to select symbols from libc.
	(clib-routines): Add some symbols; move defn to kernel linking page.
	This variable is now a list of symbols allowed to be undefined,
	rather than a prescriptive list of symbols always grabbed from libc.
	(kernel): Rewrite this rules to just link kernel.o and clib-routines.o
	together to make the kernel image.

1999-09-15  Mark Kettenis  <kettenis@gnu.org>

	* i386/i386/user_ldt.c: Fix user LDT management.
	(i386_set_ldt): Prevent thrashing the LDT for the current thread.
	Correctly calculate size of new LDT.  Set base adress of the LDT
	descriptor to the linear address of the LDT instead of the kernel
	virtual address.  Copy descriptors from the default LDT if there
	is no old LDT for the current thread.  Call switch_ktss if we are
	setting a new LDT for the current thread.
	(i386_get_ldt): Fix bug in copying out the descriptors.

1999-09-09  Thomas Bushnell, BSG  <tb@mit.edu>

	* linux/src/drivers/net/rtl8139.c (RX_BUF_LEN_IDX): Reduce from 3
	to 2.  (64K exceeds the limits in linux/dev/glue/kmem.c:kmalloc.)
	(rtl8129_open): If we fail to get the memory we need, then free
	the IRQ before returning.
	Reported by Daniel Kobras <daniel.kobras@student.uni-tuebingen.de>.

1999-09-07  Thomas Bushnell, BSG  <tb@mit.edu>

	* linux/src/drivers/net/yellowfin.c (yellowfin_probe): Return
	correct value.  Reported by Marcus Brinkmann
	<Marcus.Brinkmann@ruhr-uni-bochum.de>.

	* linux/dev/drivers/net/Space.c: Declare tc515_probe.  Reported by
	Marcus Brinkmann <Marcus.Brinkmann@ruhr-uni-bochum.de>.

1999-09-04  Thomas Bushnell, BSG  <tb@mit.edu>

	* vm/vm_resident.c (vm_page_grab): Only block unprivileged
	allocations over vm_page_external_limit if they are actually
	external allocations.  Reported by Mark Kettenis
	(kettenis@wins.uva.nl>.

1999-08-10  Thomas Bushnell, BSG  <tb@mit.edu>

	* i386/i386at/model_dep.c (init_alloc_aligned): Revert previous
	change except for the one to AVAIL_NEXT.  All the rest of the
	previous code was correct.  Correction from Momchil Velikov
	(velco@fadata.bg).

1999-07-23  Roland McGrath  <roland@baalperazim.frob.com>

	* Drivers.macros (AC_DRIVER): Use `test' instead of `[ ... ]'.
	Reported by "Momchil 'Velco' Velikov" <velco@fadata.bg>.

1999-07-20  Roland McGrath  <roland@baalperazim.frob.com>

	* linux/dev/drivers/block/genhd.c (check_partition): Change message
	to say these are only the DOS partitions.
	* i386/linux/dev/include/linux/autoconf.h (CONFIG_BSD_DISKLABEL,
	CONFIG_SMD_DISKLABEL): #undef these.  The dev/glue/block.c code
	deals with BSD disklabels and expects the Linux genhd.c code to
	handle only the DOS partitions; having genhd.c do BSD disklabels
	too just confuses things.

	Force subdirectory targets so they get recompiled properly.
	* i386/Makefile.in (linux/linux.o): Depend on FORCE instead of linux.
	(FORCE): New target.
	* i386/Makefrag (i386/sysdep.o, FORCE): Likewise.

1999-07-11  Thomas Bushnell, BSG  <tb@mit.edu>

	* i386/i386at/model_dep.c (init_alloc_aligned): Make the checks
	correctly for addresses falling into skip regions.  Reported by
	Momchil Velikov (velco@fadata.bg).

1999-07-01  Thomas Bushnell, BSG  <tb@mit.edu>

	* i386/linux/Makefile.in: For each .o file in $(linux-objs)
	include a corresponding .d file, unless `no_deps' is `t'.
	(make-deps): New function.
	(%.d): New pattern rules for building %.d from %.c and %.S.

1999-06-29  Thomas Bushnell, BSG  <tb@mit.edu>

	* vm/vm_resident.c (vm_page_grab): Don't bounce requests when
	vm_page_external_count == vm_page_external_limit, so that before
	initialization is complete we can still allocate memory without
	relying on current_thread.
	(vm_page_wait): Also block if we are over the external page
	limit.
	* vm/vm_pageout.c (vm_pageout_scan): Rewrite the
	scan-for-pages-to-pageout loop to not crash when we hit the end of
	the inactive queue; instead jump back to the
	pause-for-a-little-while code.

1999-06-27  Thomas Bushnell, BSG  <tb@mit.edu>

	* vm/vm_resident.c (vm_page_external_count): Define variable.
	(vm_page_grab): New argument `external'.  All callers changed.
	Keep track of number of externally managed pages.  Don't let
	non-privileged threads exceed the externally-managed page limit.
	(vm_page_grab_contiguous_pages): New argument `external'.  All
	callers changed.  Keep track of number of externally managed
	pages.  Don't let non-privileged threads exceed the
	externally-managed page limit.
	(vm_page_convert): New argument `external', handed off to
	vm_page_grab.  All callers changed.
	(vm_page_release): New argument `external'.  All callers
	changed. Keep track of number of externally managed pages.
	(vm_page_bootstrap): Initialize M->external.
	(vm_page_external_limit): Define new variable.
	(vm_page_grab_phys_addr, vm_page_alloc): Add new arg for
	vm_page_grab.
	(vm_page_free): Provide new arg to vm_page_release.
	* vm/vm_page.h (vm_page_external_limit, vm_page_external_count):
	New variables.
	(struct vm_page): New members `external' and `extcounted'.
	(vm_page_grab, vm_page_release, vm_page_convert): Specify new
	argument.
	* vm/vm_pageout.c (vm_pageout): Initialize vm_page_external_limit
	and vm_page_external_target.
	(VM_PAGE_EXTERNAL_LIMIT, VM_PAGE_EXTERNAL_TARGET): New macro.
	(vm_page_external_target): New variable.
	(vm_pageout_scan): Regard "too many externally managed pages" as a
	reason to keep doing work, but if that's the only reason we're
	doing work, then the only thing we do is schedule cleaning of
	pages.  Help keep track of the number of externally managed pages
	that we care about.
	* i386/intel/pmap.c (pmap_page_table_page_alloc): Add new arg for
	vm_page_grab.
	* linux/dev/glue/block.c (alloc_buffer, device_read): Likewise.
	* vm/vm_map.c (vm_map_copy_steal_pages): Likewise.
	* vm/vm_fault.c (vm_fault_page): Add new args for vm_page_grab and
	vm_page_convert.

	* vm/vm_pageout.c (VM_PAGEOUT_BURST_WAIT): Reduce to 10ms/page.
	(VM_PAGEOUT_EMPTY_WAIT): Reduce to 75 ms.
	(VM_PAGE_FREE_RESERVED): Increase to 50 pages.
	(VM_PAGEOUT_RESERVED_INTERNAL): Adjust to `(reserve) - 25'.
	(VM_PAGEOUT_RESERVED_REALLY): Adjust to `(reserve) - 40'.

1999-06-21  Thomas Bushnell, BSG  <tb@mit.edu>

	* i386/Files: Don't mention i386/pc/Makerules,
	i386/include/Makerules, or i386/util/Makerules.

	* Makefile.in (all-real-archs): Delete variable.
	(dist): No longer make `machine' symlink.

	* Makefile.in (dist): Sanify file permissions before building tar
	file.

	* i386/Subdirs: Remove i386/i386at/boot.

Sun Jun 20 18:33:59 1999  Thomas Bushnell, BSG  <tb@mit.edu>

	* version.c (version): Updated to version 1.2.

	* i386/Files: Regenerated.
	* i386/Subdirs: Regenerated.

	* linux/Files: New file.
	* linux/Subdirs: New file.
	* Makefile.in (all-archs): Add `linux'.
	(all-real-archs): New variable.
	(dist): Create `machine' symlink only on
	$(all-real-archs).

	* Makefile.in (dist): Use `cp' instead of `ln'.

	* config.guess: Updated from autoconf 2.13.
	* config.sub: Likewise.

1999-06-16  Thomas Bushnell, BSG  <tb@mit.edu>

	* linux/dev/drivers/net/Space.c (ethif_probe): Probe tc59x_probe
	(CONFIG_VORTEX) after el3_probe (CONFIG_EL3), because the latter
	card matches the former probe, but the driver doesn't work with
	it.  Reported by Marcus Brinkmann <brinkmd@debian.org>.

	* Drivers.macros (AC_DRIVER): Only turn on driver if $enableval is
	not `no'.  Reported by Kalle Olavi Niemitalo <tosi@ees2.oulu.fi>.

1999-06-15  Thomas Bushnell, BSG  <tb@mit.edu>

	* ipc/ipc_init.c (ipc_bootstrap): Don't make the IOT_PORT zone
	exhaustible, because allocation of ports for internal objects
	panics if zalloc fails.

1999-06-07  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linux/dev/drivers/block/genhd.c [MACH] (mach_minor): New variable.
	(add_bsd_partition): New function.
	(bsd_disklabel_partition) [MACH]: Call add_bsd_partition.
	(msdos_partition) [MACH]: Set mach_minor to MINOR before
	calling bsd_disklabel_partition.
	* linux/dev/drivers/block/ide.c (do_request) [MACH]: Fix "bad access"
	message.

1999-06-02  Roland McGrath  <roland@baalperazim.frob.com>

	* kern/bootstrap.c (build_args_and_stack): If kernel_cmdline is
	nonempty, give the bootstrap task an environment variable of
	"MULTIBOOT_CMDLINE=kernel command line" on its stack.

1999-05-29  Roland McGrath  <roland@baalperazim.frob.com>

	* kern/startup.c (start_kernel_threads): Call record_time_stamp to
	reset the kernel task's creation_time field, so it's not zero.

1999-05-24  Mark Kettenis  <kettenis@gnu.org>

	* i386/i386/fpu.c (fp_free): Clear task switch flag before calling
	fwait.
	(fpu_get_state): Only save FPU state info if the live FPU state
	belongs to our target, i.e. if THREAD is the current thread.
	(fp_load): Print warning if we try to load an invalid FPU state,
	and reset the FPU to some sane state instead.

1999-05-23  Roland McGrath  <roland@baalperazim.frob.com>

	* kern/task.c (task_info): Allow count for TASK_BASIC_INFO to be less
	two words, not just one.  The new member creation_time is two words.

1999-05-22  Roland McGrath  <roland@baalperazim.frob.com>

	* linux/configure: Regenerated.

1999-05-21  Roland McGrath  <roland@baalperazim.frob.com>

	* linux/configure.in: Fix names dummy -> dummy.in in AC_OUTPUT call.

1999-05-14  Roland McGrath  <roland@baalperazim.frob.com>

	* i386/linux/Drivers.in (linux_DRIVER): New macro, does AC_DRIVER and
	defines alias for Linux module name.  Use that for all single-module
	Linux drivers, so we don't forget to define any of the aliases for the
	Linux module names.
	* i386/linux/configure: Regenerated.

1999-04-28  OKUJI Yoshinori  <okuji@localhost>

	* linux/dev/drivers/block/genhd.c (bsd_disklabel_partition) [MACH]:
	Print BSD slices, using Mach device syntax instead of Linux extented
	partition syntax.

1999-05-01  Mark Kettenis  <kettenis@gnu.org>

	* linux/dev/glue/block.c (device_get_status): Always set
	status_count to DEV_GET_STATUS_COUNT if flavor is DEV_GET_SIZE.

1999-04-30  Roland McGrath  <roland@baalperazim.frob.com>

	* i386/linux/Drivers.in: Don't create asm-${systype} symlinks here.
	* linux/configure.in: New file.  Create them here instead.
	* linux/dummy.in: New file, used by configure.
	* linux/configure: New file (generated by autoconf).
	* configure.in: Configure in linux subdir.
	* configure: Regenerated.

	* i386/configure.in: Require only autoconf 2.12, not 2.13.
	* i386/configure: Regenerated.

	* aclocal.m4 (hurd_SYSTYPE): New macro.
	* i386/linux/Drivers.in: Use it.
	* i386/linux/configure: Regenerated.

Wed Apr 28 02:17:51 1999  Thomas Bushnell, BSG  <tb@mit.edu>

	* linux/src/drivers/net/3c59x.c: Upgrade to Linux 2.2.1 version.
	(vortex_start_xmit): Don't frob VP->stat.tx_bytes.
	(boomerang_start_xmit): Likewise.
	(vortex_rx): Don't frob VP->stats.rx_bytes.
	(boomerang_rx): Likewise.
	Requested by Jeff Bailey (jbailey@nisa.net).

Mon Apr 26 02:13:02 1999  Thomas Bushnell, BSG  <tb@mit.edu>

	* Makefile.in (objfiles): Don't add $(systype)/sysdep.o here.
	($(systype)/sysdep.o): Delete rule.
	(clean, distclean, mostlyclean, maintainerclean, install-headers,
	install-kernel): Don't do recursive make here.
	* i386/Makefrag (objfiles): Add i386/sysdep.o to the list.
	(i386/sysdep.o): New rule.
	(clean): Depend on i386-clean.
	(distclean): Depend on i386-distclean.
	(mostlyclean): Depend on i386-mostlyclean.
	(maintainerclean): Depend on i386-maintainerclean.
	(install-headers): Depend on i386-install-headers.
	(install-kernel): Depend on i386-install-kernel.
	(i386-clean, i386-distclean, i386-mostlyclean,
	i386-maintainerclean, i386-install-kernel, i386-install-headers):
	New rules.

1999-04-14  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* version.c (version): Update to 1.1.92.

Sun Mar 14 18:53:01 1999  Thomas Bushnell, BSG  <tb@mit.edu>

	* device/ds_routines.c (ds_read_done): When touching memory to
	mark it dirty, make sure we say "volatile" so the compiler doesn't
	optimize it out.

1999-04-12  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/linux/Drivers.in: Fix the source paths for `asm'	symbolic
	links. Reported by KONISHI Toru <sting@mb.infoweb.ne.jp>.

	* linux/dev/drivers/block/ide.c (init_hwif_data) [MACH]: Print Mach
	device name instead of Linux one.
	* linux/dev/drivers/block/genhd.c (disk_name): Likewise.
	* linux/dev/drivers/scsi/sd.c (sd_init_onedisk): Likewise.
	(sd_detect): Likewise.
	* linux/dev/drivers/sr.c (sr_detect): Likewise.
	(get_sectorsize): Likewise.

1999-03-01  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	Version 1.1.91.

	* version.c (version): Update to 1.1.91.

1999-03-01  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/linux/Drivers.in: Fix linking paths.
	* i386/linux/Makefile.in: Corrent include paths and fix
	Drivers.macros location.

1999-02-28  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* Makefile.in (clean): Don't move device-drivers.h, because it is
	not in the top directory any longer.
	(distclean): Remove config.cache and config.log.
	* i386/Makefile.in (distclean): Remove config.status, config.log
	and Makefile.
	* i386/linux/Makefile.in (distclean): Remove config.status,
	config.log, Makefile and device-drivers.h.

1999-02-27  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/linux/Drivers.in: Don't link dev/include/asm-i386 to
	dev/include/asm. Check if directories already exist before
	mkdir_p's. Link directories manually, because AC_LINK_FILES
	is weak in linking files from non-current directories.

	* i386/i386at/i386at_ds_routines.c: Include
	<i386/linux/device-drivers.h> instead of <linux/device-drivers.h>.
	* device/ds_routines.c [LINUX_DEV]: Likewise.
	* i386/linux/Makefile.in (linux-gen-flags): Fix an extra slash.
	(distclean): Remove asm links.
	* linux/src/COPYING: Copied from linux-2.0.36.

1999-02-27  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* Makefile.in: Omit to detect if com or lpr is used, and don't use
	linux.o.
	(objfiles): Add $(systype)/sysdep.o.
	(clean): Chain the target to $(systype).
	(distclean): Likewise.
	(mostlyclean): Likewise.
	(maintainer-clean): Likewise.
	(install-headers): Likewise.
	(install-kernel): Likewise.
	* configure.in: AC_CONFIG_SUBDIRS ${systype} instead of linux.
	(--disable-linuxdev): Deleted.
	(--disable-com): Likewise.
	(--enable-lpr): Likewise.
	* i386/Makefile.in: New file.
	* i386/configure.in: Likewise.
	* i386/Makefrag (DEFINES): Add -DLINUX_DEV.
	(objfiles): Always add com.o. If MACH_LPR is defined, then add lpr.o.
	* linux/Drivers.in: Moved to ...
	* i386/linux/Drivers.in: ... here. Include ../../aclocal.m4.
	(mkdir_p): New function to create the linux include dirs.
	* linux/Makefile.in: Moved to ...
	* i386/linux/Makefile.in: ... here, and modify so that paths
	are valid.
	(clean): New target.
	(distclean): Likewise.
	(mostlyclean): Likewise.
	(maintainer-clean): Likewise.
	* linux/src/include/linux/autoconf.h: Removed.
	* linux/dev/include/linux/autoconf.h: Moved to ...
	* i386/linux/dev/include/linux/autoconf.h: ... here.
	* linux/dev/arch/i386/linux_emul.h: Moved to ...
	* i386/linux/dev/include/linux_emul.h: ... here.
	* linux/device-drivers.h.in: Moved to ...
	* i386/linux/device-drivers.h.in: ... here.
	* linux/aclocal.m4: Removed.
	* linux/configure: Likewise.

1999-02-14  Gordon Matzigkeit  <gord@trick.fig.org>

	* Makefile.in (install-kernel): Be sure that $(bootdir) is
	created before installing the kernel.

1999-02-06  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* configure.in: Enable com by default, because current kbd and
	mouse can't be linked without com. Reported by M. Meiarashi
	<mes@st.rim.or.jp>.

1999-02-05  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	Version 1.1.90.

	* version.c (version): Update to 1.1.90.

1999-02-04  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* device/kmsg.c (kmsginit): Add a missing semicolon.
	(kmsggetstat): Fix typos,
	DEV_GET_DEVICE_SIZE -> DEV_GET_SIZE_DEVICE_SIZE and
	DEV_GET_RECORD_SIZE -> DEV_GET_SIZE_RECORD_SIZE.
	(kmsg_putchar): Fix a typo kmsg_done_init -> kmsg_init_done.
	* linux/dev/glue/block.c (device_get_status): Allocate a hd_geometry
	on the stack.
	* linux/dev/drivers/block/ide.c: New file.
	* linux/dev/drivers/scsi/sd_ioctl.c: New file.

1999-02-02  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/i386at/kd_event.c (kbdgetstat): Fix a typo
	DEV_GET_SIZES -> DEV_GET_SIZE.
	* i386/i386at/kd_mouse.c (mousegetstat): Likewise.
	* device/kmsg.c (kmsggetstat): Likewise.

1999-02-01  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linux/dev/glue/block.c (dev_getstat): Fix a missing `struct'.
	* device/cons.c (cninit): Don't call kmsginit.
	* kmsg.c (kmsg_buffer): Defined as static.
	(kmsg_write_offset): Likewise.
	(kmsg_read_offset): Likewise.
	(kmsg_read_queue): Likewise.
	(kmsg_in_use): Likewise.
	(kmsg_lock): Likewise.
	(kmsginit): Likewise, and call queue_init instead of setting
	PREV and NEXT manually.
	(kmsg_done_init): New variable.
	(kmsg_putchar): Call kmsginit if not initialized yet.
	(kmsggetstat): New function.
	* kmsg.h (kmsggetstat): Add the prototype.
	* i386/i386at/kd_event.c (kbdgetstat): Handle DEV_GET_SIZE.
	(kbdread): Check if the amount a user specify is a multiple
	of sizeof(kd_event).
	* i386/i386at/kd_mouse.c (mousegetstat): New function.
	(mouseread): Check if the amount a user specify is a multiple
	of sizeof(kd_event).
	* i386/i386at/conf.c (dev_name_list): Set the mouse getstat entry
	to mousegetstat and the kmsg getstat entry to kmsggetstat.
	Use MACH_COM instead of NCOM to determine if com is used.
	Use MACH_LPR instead of NLPR to determine if lpr is used.
	* configure.in (--enable-com): New option.
	(--enable-lpr): Likewise.
	* Makefile.in (enable_com): New variable.
	(enable_lpr): Likewise.
	* i386/Makefrag (i386at-files): Remove com.c.
	(objfiles): Add com.o if enable_com is yes, and lpr.o if enable_lpr
	is yes.

Tue Jan 26 21:36:10 1999  Thomas Bushnell, BSG  <tb@mit.edu>

	* kern/exception.c (exception_no_server): Correctly comment out
	the suspend code.  (This should have happened on 17 April 1997,
	but apparently I did it backwards.)

1999-01-26  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* device/kmsg.c (kmsgopen): Added simple_lock and simple_unlock.
	(ksmgclose): Likewise.

1999-01-25  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* Makefile.in (install-headers): New target for installing only
	the headers.
	(install-kernel): New target for installing only the kernel.
	(mkheaderdirs): New target for making the headers
	installation directories.
	(mkkerneldirs): New target for making the kernel
	installation directory.
	(install): Do nothing by itself, but depend on install-kernel
	and install-headers.

1999-01-24  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* device/kmsg.h (KMSGBUFSIZE): Deleted.
	* device/kmsg.c: Rewritten completely to provide stream interface.
	* linux/dev/glue/block.c (device_getstat): Added V_GETPARMS support.
	* config.guess: New version from automake-1.4.
	* config.sub: Likewise.
	* install-sh: Likewise.

	Some changes were merged from gnumach-m68k by
	Aymeric Vincent <vincent@emi.u-bordeaux.fr>.

	* Makefile.in (clean): Don't hang if device-drivers.h doesn't exist.
	* linux/Makefile.in (CPPFLAGS): Fix a typo.

1999-01-16  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* device/kmsg.c: Fixed the copyright notice.
	(MACH_KMSG): Removed.
	* Makefile.in (enable_kmsg): New variable.
	(objfiles): Add kmsg.o, if and only if enable_kmsg is yes.

1999-01-10  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/i386at/kd.c: Applied a keymap patch. Reported by
	Marcus Brinkmann <Marcus.Brikmann@ruhr-uni-bochum.de>.
	* i386/i386at/kd.h: Likewise.

1998-12-30  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linux/dev/glue/net.c (dev_alloc_skb): Change the skb arragement.
	(dev_kfree_skb): Free only skb.
	(device_write): Keep skb elements up-to-date.

1998-12-18  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* Makefile.in (objfiles): Add kmsg.o.
	* device/cons.c: Include <device/io_req.h>.
	* device/kmsg.c: Rewritten almost entirely.

1998-12-06  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	Add kmsg device.

	* Makefile.in (device-files): Add kmsg.c and kmsg.h.
	* configure.in (--enable-kmsg): New option.
	* device/cons.c: Include kmsg.h.
	(cninit): Call kmsginit if MACH_KMSG is defined.
	(cnputc): Call kmsg_putchar if MACH_KMSG is defined.
	* device/kmsg.c: New file.
	* device/kmsg.h: Likewise.
	* i386/i386at/conf.c (dev_name_list): Add kmsg entry.

1998-12-02  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* configure.in: Fix linuxdev option handling.
	* linux/Drivers.in: Remove linuxdev option and fix linking files.
	* linux/Makefile.in: Replace @DEFS@ with -DLINUX_DEV.
	* linux/dev/arch/i386/kernel/irq.c: Include missing header files.
	* linux/dev/arch/i386/kernel/setup.c: Include <device-drivers.h>.
	* linux/dev/glue/kmem.c: Add printf declaration.
	* linux/dev/glue/misc.c: Include <linux/types.h>.
	* linux/dev/init/main.c: Call linux_sched_init instead of sched_init.
	* linux/dev/kernel/sched.c: Add timer_bh declaration.
	(tqueue_bh): Fix the argument.
	(linux_sched_init): Renamed from sched_init.

1998-12-01  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/i386at/i386at_ds_routines.c: Include <linux/device-drivers.h>
	only if LINUX_DEV is defined. Reported by UCHIYAMA Yasushi
	<uch@nop.or.jp>.
	* device/ds_routines.c: Likewise.
	* configure.in: AC_CONFIG_SUBDIRS(linux) instead of linuxdev.
	(--disable-linuxdev): New option.
	* linux/Makefile.in (CPPFLAGS): Remove -DLINUX_DEV, and add @DEFS@.
	(objfiles): Add linux.o only if LINUX_DEV is defined.
	* linux/Drivers.in (--disable-linuxdev): New option.
	* i386/Makefrag (DEFINES): Remove -DLINUX_DEV.

1998-11-30  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	Clean up linux emulation code to make it architecture-independent
	as much as possible.

	* linux: Renamed from linuxdev.
	* Makefile.in (objfiles): Add linux.o instead of linuxdev.o.
	(MAKE): New variable. Used for the linux.o target.
	* configure.in: Add AC_CHECK_TOOL(MAKE, make).
	* i386/i386/spl.h: Include <i386/ipl.h>, for compatibility with
	OSF Mach 3.0. Suggested by Elgin Lee <ehl@funghi.com>.
	* linux/src: Renamed from linux/linux.
	* linux/dev: Renamed from linux/mach.
	* linux/Drivers.in (AC_INIT): Use dev/include/linux/autoconf.h,
	instead of mach/include/linux/autoconf.h.
	* Makefile.in (all): Target ../linux.o instead of ../linuxdev.o.
	* linux/dev/drivers/block/genhd.c: Include <machine/spl.h> instead
	of <i386/ipl.h>.
	* linux/dev/drivers/net/auto_irq.c: Remove unneeded header files,
	<i386/ipl.h> and <i386/pic.h>.
	* linux/dev/init/main.c: Many i386-dependent codes moved to ...
	* linux/dev/arch/i386/irq.c: ... here.
	* linux/dev/arch/i386/setup.c: New file.
	* linux/dev/arch/i386/linux_emul.h: Likewise.
	* linux/dev/arch/i386/glue/timer.c: Merged into sched.c.
	* linux/dev/arch/i386/glue/sched.c: Include <machine/spl.h> instead
	of <i386/ipl.h>, and moved to ...
	* linux/dev/kernel/sched.c: ... here.
	* linux/dev/arch/i386/glue/block.c: Include <machine/spl.h> and
	<linux_emul.h>, instead of i386-dependent header files, and
	moved to ...
	* linux/dev/glue/blocl.c: ... here.
	* linux/dev/arch/i386/glue/net.c: Include <machine/spl.h> and
	<linux_emul.h>, instead of i386-dependent header files, and
	moved to ...
	* linux/dev/glue/net.c: ... here.
	* linux/dev/arch/i386/glue/misc.c: Remove `x86' and moved to ...
	* linux/dev/glue/misc.c: ... here.
	* linux/dev/arch/i386/glue/kmem.c: Moved to ...
	* linux/dev/glue/kmem.c: ... here.

1998-11-25  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linuxdev/mach/init/main.c (linux_init): Call reserve_mach_irqs.
	* linuxdev/mach/arch/i386/kernel/irq.c (probe_irq_on): Fix ivect
	mishandling.
	(probe_irq_off): Disable unnecessary IRQs. Reported by
	UCHIYAMA Yasushi <uch@nop.or.jp>.
	(reserve_mach_irqs): New function.

1998-11-24  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linuxdev/arch/i386/linux_init.c (linux_init): Check ivect
	before set linux_bad_intr.
	* linuxdev/arch/i386/linux_irq.c (probe_irq_on): Allocate only
	if ivect is null, and set linux_intr_pri to intpri.

	* linuxdev: Heavily changed. It becomes more Linux-like file
	hierarchy as suggested by Roland McGrath <roland@frob.com>.
	* linuxdev/linux: Contain original Linux source files.
	* linuxdev/mach: Contain modified source files for Mach.
	* linuxdev/mach/arch/i386/glue: XXX Contain files that are
	not easy to segregate.
	* Makefile.in: Call `make -C linuxdev all', instead of include
	linuxdev/Makefrag.

1998-11-23  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linuxdev/arch/i386/linux_irq.c (linux_bad_intr): New function.
	(free_irq): Set linux_bad_intr into ivect[irq].
	* linuxdev/arch/i386/linux_init.c (linux_init):
	Set linux_bad_intr as the default interrupt handler.

	* linuxdev/include/asm-i386/string.h (strstr): Fix the
	egcs/gcc 2.8.x bug and a linkage problem. Reported by
	Roland McGrath <roland@frob.com>.

1998-11-18  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linuxdev/Drivers.in: Fix a typo.
	* linuxdev/Makefrag: Likewise.
	* linuxdev/arch/i386/linux_block.c (set_blocksize): Likewise.

	* linuxdev/arch/i386/linux_kmem.c (vfree): Cast void * to
	vm_offset_t.
	* linuxdev/drivers/net/wavelan.p.h: Include
	<linuxdev/drivers/net/i82586.h>, instead of <drivers/net/i82586.h>.
	* linuxdev/drivers/scsi/aha152x.c: Define AUTOCONF.
	* linuxdev/configure: Regenerate.

1998-11-17  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* linuxdev/arch/i386/linux_misc.c (strstr): New function.
	Because	inline version strstr is not used when use
	egcs/gcc 2.8.x.	Reported by UCHIYAMA Yasushi <uch@nop.or.jp>.

	* linuxdev/arch/i386/linux_irq.c (unmask_irq): Fix a typo.

1998-11-17  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/README-Drivers: Update to Linux 2.0.36 device drivers.
	* linuxdev/Drivers.in: Likewise.
	* linuxdev/Makefrag: Likewise.
	* linuxdev/arch/i386/linux_lib.S: Likewise.
	* linuxdev/device-drivers.h.in: Likewise.
	* linuxdev/drivers/block/floppy.c: Likewise.
	* linuxdev/drivers/block/ide.c: Likewise.
	* linuxdev/drivers/block/ide.h: Likewise.
	* linuxdev/drivers/net/3c505.h: Likewise.
	* linuxdev/drivers/net/3c509.c: Likewise.
	* linuxdev/drivers/net/3c515.c: Likewise.
	* linuxdev/drivers/net/3c59x.c: Likewise.
	* linuxdev/drivers/net/Space.c: Likewise.
	* linuxdev/drivers/net/apricot.c: Likewise.
	* linuxdev/drivers/net/de4x5.c: Likewise.
	* linuxdev/drivers/net/eepro.c: Likewise.
	* linuxdev/drivers/net/eepro100.c: Likewise.
	* linuxdev/drivers/net/eexpress.c: Likewise.
	* linuxdev/drivers/net/epic100.c: Likewise.
	* linuxdev/drivers/net/eth16i.c: Likewise.
	* linuxdev/drivers/net/hp100.c: Likewise.
	* linuxdev/drivers/net/lance.c: Likewise.
	* linuxdev/drivers/net/ne2k-pci.c: Likewise.
	* linuxdev/drivers/net/pcnet32.c: Likewise.
	* linuxdev/drivers/net/rtl8139.c: Likewise.
	* linuxdev/drivers/net/tlan.c: Likewise.
	* linuxdev/drivers/net/tulip.c: Likewise.
	* linuxdev/drivers/net/wavelan.c: Likewise.
	* linuxdev/drivers/pci/pci.c: Likewise.
	* linuxdev/drivers/scsi/BusLogic.c: Likewise.
	* linuxdev/drivers/scsi/FlashPoint.c: Likewise.
	* linuxdev/drivers/scsi/aha152x.c: Likewise.
	* linuxdev/drivers/scsi/aha1542.c: Likewise.
	* linuxdev/drivers/scsi/aic7xxx/sequencer.h: Likewise.
	* linuxdev/drivers/scsi/aic7xxx.c: Likewise.
	* linuxdev/drivers/scsi/aic7xxx_proc.c: Likewise.
	* linuxdev/drivers/scsi/aic7xxx_reg.h: Likewise.
	* linuxdev/drivers/scsi/dtc.c: Likewise.
	* linuxdev/drivers/scsi/eata.c: Likewise.
	* linuxdev/drivers/scsi/eata.h: Likewise.
	* linuxdev/drivers/scsi/eata_dma.c: Likewise.
	* linuxdev/drivers/scsi/gdth.c: Likewise.
	* linuxdev/drivers/scsi/gdth.h: Likewise.
	* linuxdev/drivers/scsi/gdth_proc.c: Likewise.
	* linuxdev/drivers/scsi/gdth_proc.h: Likewise.
	* linuxdev/drivers/scsi/hosts.c: Likewise.
	* linuxdev/drivers/scsi/in2000.c: Likewise.
	* linuxdev/drivers/scsi/in2000.h: Likewise.
	* linuxdev/drivers/scsi/ncr53c8xx.c: Likewise.
	* linuxdev/drivers/scsi/ppa.h: Likewise.
	* linuxdev/drivers/scsi/scsi.c: Likewise.
	* linuxdev/drivers/scsi/scsicam.c: Likewise.
	* linuxdev/drivers/scsi/sd.c: Likewise.
	* linuxdev/drivers/scsi/seagate.c: Likewise.
	* linuxdev/drivers/scsi/u14-34f.c: Likewise.
	* linuxdev/drivers/scsi/u14-34f.h: Likewise.
	* linuxdev/drivers/scsi/wd7000.c: Likewise.
	* linuxdev/drivers/scsi/wd7000.h: Likewise.
	* linuxdev/include/asm-i386/irq.h: Likewise.
	* linuxdev/include/asm-i386/processor.h: Likewise.
	* linuxdev/include/asm-i386/ptrace.h: Likewise.
	* linuxdev/include/asm-i386/system.h: Likewise.
	* linuxdev/include/asm-i386/unistd.h: Likewise.
	* linuxdev/include/linux/fs.h: Likewise.
	* linuxdev/include/linux/genhd.h: Likewise.
	* linuxdev/include/linux/interrupt.h: Likewise.
	* linuxdev/include/linux/ip.h: Likewise.
	* linuxdev/include/linux/pci.h: Likewise.
	* linuxdev/include/linux/version.h: Likewise.
	* linuxdev/include/linux/wireless.h: Likewise.

	* linuxdev/drivers/net/via-rhine.c: New file.
	* linuxdev/drivers/scsi/aic7xxx_seq.c: Likewise.
	* linuxdev/include/linux/rose.h: Likewise.

	* linuxdev/drivers/scsi/aic7xxx_seq.h: Removed.
	* linuxdev/configure: Regenerate.
	* linuxdev/include/asm-i386/string.h: Fix the egcs/gcc 2.8.x problem,
	according to http://www.suse.de/~florian/kernel+egcs.html.

1998-11-14  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* Makefile.in (clib-routines.o): Add -L option to search libc.a.
	Reported by TAKEUCHI Yoji <ytakeuch@po.iijnet.or.jp>.

	* linuxdev/drivers/pci/bios32.c: Moved to ...
	* linuxdev/arch/i386/linux_bios32.c: ... here. Because it is
	i386-specific code.
	* linuxdev/include/asm: Moved to ...
	* linuxdev/include/asm-i386: ... here.

	* i386/README-Drivers: Update to Linux 2.0.35 device drivers.
	* linuxdev/Drivers.in: Likewise.
	* linuxdev/configure: Likewise.
	* linuxdev/device-drivers.h.in: Likewise.
	* linuxdev/Makefrag: Likewise.
	* linuxdev/arch/i386/linux_autoirq.c: Likewise.
	* linuxdev/arch/i386/linux_block.c: Likewise.
	* linuxdev/arch/i386/linux_dma.c: Likewise.
	* linuxdev/arch/i386/linux_init.c: Likewise.
	* linuxdev/arch/i386/linux_irq.c: Likewise.
	* linuxdev/arch/i386/linux_kmem.c: Likewise.
	* linuxdev/arch/i386/linux_misc.c: Likewise.
	* linuxdev/arch/i386/linux_net.c: Likewise.
	* linuxdev/arch/i386/linux_port.c: Likewise.
	* linuxdev/arch/i386/linux_printk.c: Likewise.
	* linuxdev/arch/i386/linux_sched.c: Likewise.
	* linuxdev/arch/i386/linux_timer.c: Likewise.
	* linuxdev/arch/i386/linux_version.c: Likewise.
	* linuxdev/arch/i386/linux_vsprintf.c: Likewise.
	* linuxdev/drivers/block/cmd640.c: Likewise.
	* linuxdev/drivers/block/floppy.c: Likewise.
	* linuxdev/drivers/block/genhd.c: Likewise.
	* linuxdev/drivers/block/ide-cd.c: Likewise.
	* linuxdev/drivers/block/ide.c: Likewise.
	* linuxdev/drivers/block/ide.h: Likewise.
	* linuxdev/drivers/block/ide_modes.h: Likewise.
	* linuxdev/drivers/block/rz1000.c: Likewise.
	* linuxdev/drivers/block/triton.c: Likewise.
	* linuxdev/drivers/net/3c501.c: Likewise.
	* linuxdev/drivers/net/3c503.c: Likewise.
	* linuxdev/drivers/net/3c505.c: Likewise.
	* linuxdev/drivers/net/3c507.c: Likewise.
	* linuxdev/drivers/net/3c509.c: Likewise.
	* linuxdev/drivers/net/3c59x.c: Likewise.
	* linuxdev/drivers/net/8390.c: Likewise.
	* linuxdev/drivers/net/8390.h: Likewise.
	* linuxdev/drivers/net/Space.c: Likewise.
	* linuxdev/drivers/net/ac3200.c: Likewise.
	* linuxdev/drivers/net/apricot.c: Likewise.
	* linuxdev/drivers/net/at1700.c: Likewise.
	* linuxdev/drivers/net/atp.c: Likewise.
	* linuxdev/drivers/net/atp.h: Likewise.
	* linuxdev/drivers/net/de4x5.c: Likewise.
	* linuxdev/drivers/net/de4x5.h: Likewise.
	* linuxdev/drivers/net/de600.c: Likewise.
	* linuxdev/drivers/net/de620.c: Likewise.
	* linuxdev/drivers/net/depca.c: Likewise.
	* linuxdev/drivers/net/dev.c: Likewise.
	* linuxdev/drivers/net/e2100.c: Likewise.
	* linuxdev/drivers/net/eepro.c: Likewise.
	* linuxdev/drivers/net/eepro100.c: Likewise.
	* linuxdev/drivers/net/eexpress.c: Likewise.
	* linuxdev/drivers/net/eth16i.c: Likewise.
	* linuxdev/drivers/net/ewrk3.c: Likewise.
	* linuxdev/drivers/net/ewrk3.h: Likewise.
	* linuxdev/drivers/net/hp-plus.c: Likewise.
	* linuxdev/drivers/net/hp.c: Likewise.
	* linuxdev/drivers/net/hp100.c: Likewise.
	* linuxdev/drivers/net/hp100.h: Likewise.
	* linuxdev/drivers/net/i82586.h: Likewise.
	* linuxdev/drivers/net/lance.c: Likewise.
	* linuxdev/drivers/net/ne.c: Likewise.
	* linuxdev/drivers/net/net_init.c: Likewise.
	* linuxdev/drivers/net/ni52.c: Likewise.
	* linuxdev/drivers/net/ni52.h: Likewise.
	* linuxdev/drivers/net/ni65.c: Likewise.
	* linuxdev/drivers/net/ni65.h: Likewise.
	* linuxdev/drivers/net/seeq8005.c: Likewise.
	* linuxdev/drivers/net/seeq8005.h: Likewise.
	* linuxdev/drivers/net/sk_g16.c: Likewise.
	* linuxdev/drivers/net/sk_g16.h: Likewise.
	* linuxdev/drivers/net/smc-ultra.c: Likewise.
	* linuxdev/drivers/net/tulip.c: Likewise.
	* linuxdev/drivers/net/wavelan.c: Likewise.
	* linuxdev/drivers/net/wavelan.h: Likewise.
	* linuxdev/drivers/net/wd.c: Likewise.
	* linuxdev/drivers/net/znet.c: Likewise.
	* linuxdev/drivers/pci/pci.c: Likewise.
	* linuxdev/drivers/scsi/53c7,8xx.h: Likewise.
	* linuxdev/drivers/scsi/53c78xx.c: Likewise.
	* linuxdev/drivers/scsi/53c8xx_d.h: Likewise.
	* linuxdev/drivers/scsi/AM53C974.c: Likewise.
	* linuxdev/drivers/scsi/AM53C974.h: Likewise.
	* linuxdev/drivers/scsi/BusLogic.c: Likewise.
	* linuxdev/drivers/scsi/BusLogic.h: Likewise.
	* linuxdev/drivers/scsi/NCR53c406a.c: Likewise.
	* linuxdev/drivers/scsi/NCR53c406a.h: Likewise.
	* linuxdev/drivers/scsi/advansys.c: Likewise.
	* linuxdev/drivers/scsi/advansys.h: Likewise.
	* linuxdev/drivers/scsi/aha152x.c: Likewise.
	* linuxdev/drivers/scsi/aha152x.h: Likewise.
	* linuxdev/drivers/scsi/aha1542.c: Likewise.
	* linuxdev/drivers/scsi/aha1542.h: Likewise.
	* linuxdev/drivers/scsi/aha1740.c: Likewise.
	* linuxdev/drivers/scsi/aha1740.h: Likewise.
	* linuxdev/drivers/scsi/aic7xxx.c: Likewise.
	* linuxdev/drivers/scsi/aic7xxx.h: Likewise.
	* linuxdev/drivers/scsi/aic7xxx_seq.h: Likewise.
	* linuxdev/drivers/scsi/constants.h: Likewise.
	* linuxdev/drivers/scsi/eata.c: Likewise.
	* linuxdev/drivers/scsi/eata.h: Likewise.
	* linuxdev/drivers/scsi/eata_dma.c: Likewise.
	* linuxdev/drivers/scsi/eata_dma.h: Likewise.
	* linuxdev/drivers/scsi/eata_generic.h: Likewise.
	* linuxdev/drivers/scsi/eata_pio.c: Likewise.
	* linuxdev/drivers/scsi/eata_pio.h: Likewise.
	* linuxdev/drivers/scsi/fdomain.c: Likewise.
	* linuxdev/drivers/scsi/fdomain.h: Likewise.
	* linuxdev/drivers/scsi/g_NCR5380.c: Likewise.
	* linuxdev/drivers/scsi/g_NCR5380.h: Likewise.
	* linuxdev/drivers/scsi/hosts.c: Likewise.
	* linuxdev/drivers/scsi/hosts.h: Likewise.
	* linuxdev/drivers/scsi/in2000.c: Likewise.
	* linuxdev/drivers/scsi/in2000.h: Likewise.
	* linuxdev/drivers/scsi/pas16.c: Likewise.
	* linuxdev/drivers/scsi/pas16.h: Likewise.
	* linuxdev/drivers/scsi/scsi.c: Likewise.
	* linuxdev/drivers/scsi/scsi.h: Likewise.
	* linuxdev/drivers/scsi/scsi_ioctl.c: Likewise.
	* linuxdev/drivers/scsi/scsi_proc.c: Likewise.
	* linuxdev/drivers/scsi/scsicam.c: Likewise.
	* linuxdev/drivers/scsi/sd.c: Likewise.
	* linuxdev/drivers/scsi/sd.h: Likewise.
	* linuxdev/drivers/scsi/sd_ioctl.c: Likewise.
	* linuxdev/drivers/scsi/seagate.c: Likewise.
	* linuxdev/drivers/scsi/seagate.h: Likewise.
	* linuxdev/drivers/scsi/sr.c: Likewise.
	* linuxdev/drivers/scsi/sr_ioctl.c: Likewise.
	* linuxdev/drivers/scsi/t128.c: Likewise.
	* linuxdev/drivers/scsi/t128.h: Likewise.
	* linuxdev/drivers/scsi/u14-34f.c: Likewise.
	* linuxdev/drivers/scsi/u14-34f.h: Likewise.
	* linuxdev/drivers/scsi/ultrastor.c: Likewise.
	* linuxdev/drivers/scsi/ultrastor.h: Likewise.
	* linuxdev/drivers/scsi/wd7000.c: Likewise.
	* linuxdev/drivers/scsi/wd7000.h: Likewise.
	* linuxdev/include/asm-i386/bitops.h: Likewise.
	* linuxdev/include/asm-i386/delay.h: Likewise.
	* linuxdev/include/asm-i386/dma.h: Likewise.
	* linuxdev/include/asm-i386/errno.h: Likewise.
	* linuxdev/include/asm-i386/fcntl.h: Likewise.
	* linuxdev/include/asm-i386/floppy.h: Likewise.
	* linuxdev/include/asm-i386/ioctl.h: Likewise.
	* linuxdev/include/asm-i386/floppy.h: Likewise.
	* linuxdev/include/asm-i386/irq.h: Likewise.
	* linuxdev/include/asm-i386/processor.h: Likewise.
	* linuxdev/include/asm-i386/ptrace.h: Likewise.
	* linuxdev/include/asm-i386/resource.h: Likewise.
	* linuxdev/include/asm-i386/segment.h: Likewise.
	* linuxdev/include/asm-i386/sigcontext.h: Likewise.
	* linuxdev/include/asm-i386/signal.h: Likewise.
	* linuxdev/include/asm-i386/socket.h: Likewise.
	* linuxdev/include/asm-i386/statfs.h: Likewise.
	* linuxdev/include/asm-i386/string.h: Likewise.
	* linuxdev/include/asm-i386/system.h: Likewise.
	* linuxdev/include/asm-i386/termios.h: Likewise.
	* linuxdev/include/asm-i386/types.h: Likewise.
	* linuxdev/include/asm-i386/unistd.h: Likewise.
	* linuxdev/include/linux/autoconf.h: Likewise.
	* linuxdev/include/linux/binfmts.h: Likewise.
	* linuxdev/include/linux/bios32.h: Likewise.
	* linuxdev/include/linux/blk.h: Likewise.
	* linuxdev/include/linux/blkdev.h: Likewise.
	* linuxdev/include/linux/cdrom.h: Likewise.
	* linuxdev/include/linux/config.h: Likewise.
	* linuxdev/include/linux/etherdevice.h: Likewise.
	* linuxdev/include/linux/fd.h: Likewise.
	* linuxdev/include/linux/fdreg.h: Likewise.
	* linuxdev/include/linux/fs.h: Likewise.
	* linuxdev/include/linux/genhd.h: Likewise.
	* linuxdev/include/linux/hdreg.h: Likewise.
	* linuxdev/include/linux/if.h: Likewise.
	* linuxdev/include/linux/if_arp.h: Likewise.
	* linuxdev/include/linux/if_ether.h: Likewise.
	* linuxdev/include/linux/if_tr.h: Likewise.
	* linuxdev/include/linux/igmp.h: Likewise.
	* linuxdev/include/linux/in.h: Likewise.
	* linuxdev/include/linux/inet.h: Likewise.
	* linuxdev/include/linux/interrupt.h: Likewise.
	* linuxdev/include/linux/ioport.h: Likewise.
	* linuxdev/include/linux/ip.h: Likewise.
	* linuxdev/include/linux/kernel.h: Likewise.
	* linuxdev/include/linux/locks.h: Likewise.
	* linuxdev/include/linux/major.h: Likewise.
	* linuxdev/include/linux/malloc.h: Likewise.
	* linuxdev/include/linux/mc146818rtc.h: Likewise.
	* linuxdev/include/linux/mm.h: Likewise.
	* linuxdev/include/linux/module.h: Likewise.
	* linuxdev/include/linux/mount.h: Likewise.
	* linuxdev/include/linux/net.h: Likewise.
	* linuxdev/include/linux/netdevice.h: Likewise.
	* linuxdev/include/linux/nfs.h: Likewise.
	* linuxdev/include/linux/notifier.h: Likewise.
	* linuxdev/include/linux/pagemap.h: Likewise.
	* linuxdev/include/linux/pci.h: Likewise.
	* linuxdev/include/linux/personality.h: Likewise.
	* linuxdev/include/linux/proc_fs.h: Likewise.
	* linuxdev/include/linux/quota.h: Likewise.
	* linuxdev/include/linux/route.h: Likewise.
	* linuxdev/include/linux/sched.h: Likewise.
	* linuxdev/include/linux/skbuff.h: Likewise.
	* linuxdev/include/linux/socket.h: Likewise.
	* linuxdev/include/linux/sockios.h: Likewise.
	* linuxdev/include/linux/string.h: Likewise.
	* linuxdev/include/linux/time.h: Likewise.
	* linuxdev/include/linux/timer.h: Likewise.
	* linuxdev/include/linux/tqueue.h: Likewise.
	* linuxdev/include/linux/tty.h: Likewise.
	* linuxdev/include/linux/types.h: Likewise.
	* linuxdev/include/linux/uio.h: Likewise.
	* linuxdev/include/linux/version.h: Likewise.
	* linuxdev/include/linux/wait.h: Likewise.
	* linuxdev/include/net/af_unix.h: Likewise.
	* linuxdev/include/net/ax25.h: Likewise.
	* linuxdev/include/net/ax25call.h: Likewise.
	* linuxdev/include/net/icmp.h: Likewise.
	* linuxdev/include/net/ip.h: Likewise.
	* linuxdev/include/net/ip_alias.h: Likewise.
	* linuxdev/include/net/ip_forward.h: Likewise.
	* linuxdev/include/net/ipx.h: Likewise.
	* linuxdev/include/net/netlink.h: Likewise.
	* linuxdev/include/net/netrom.h: Likewise.
	* linuxdev/include/net/nrcall.h: Likewise.
	* linuxdev/include/net/p8022.h: Likewise.
	* linuxdev/include/net/protocol.h: Likewise.
	* linuxdev/include/net/psnap.h: Likewise.
	* linuxdev/include/net/raw.h: Likewise.
	* linuxdev/include/net/route.h: Likewise.
	* linuxdev/include/net/sock.h: Likewise.
	* linuxdev/include/net/tcp.h: Likewise.
	* linuxdev/include/net/udp.h: Likewise.

	* linuxdev/arch/i386/linux_soft.c: Removed.
	* linuxdev/drivers/scsi/NCR5380.src: Likewise.
	* linuxdev/drivers/scsi/aic7xxx_proc.src: Likewise.
	* linuxdev/drivers/scsi/aic7xxx_reg.h: Likewise.
	* linuxdev/drivers/scsi/eata_dma_proc.src: Likewise.
	* linuxdev/drivers/scsi/eata_pio_proc.src: Likewise.
	* linuxdev/drivers/scsi/qlogic.c: Likewise.
	* linuxdev/drivers/scsi/qlogic.h: Likewise.
	* linuxdev/drivers/scsi/scsi_debug.c: Likewise.
	* linuxdev/drivers/scsi/scsi_debug.h: Likewise.
	* linuxdev/drivers/scsi/scsi_ioctl.h: Likewise.
	* linuxdev/include/linux/math_emu.h: Likewise.
	* linuxdev/include/linux/minix_fs.h: Likewise.
	* linuxdev/include/linux/minix_fs_sb.h: Likewise.
	* linuxdev/include/linux/scsi.h: Likewise.
	* linuxdev/include/linux/scsicam.h: Likewise.
	* linuxdev/include/linux/vm86.h: Likewise.

	* linuxdev/arch/i386/linux_ctype.c: New file.
	* linuxdev/arch/i386/linux_lib.S: Likewise.
	* linuxdev/arch/i386/linux_softirq.c: Likewise.
	* linuxdev/drivers/net/3c515.c: Likewise.
	* linuxdev/drivers/net/epic100.c: Likewise.
	* linuxdev/drivers/net/eth82586.h: Likewise.
	* linuxdev/drivers/net/fmv18x.c: Likewise.
	* linuxdev/drivers/net/ne2k-pci.c: Likewise.
	* linuxdev/drivers/net/pcnet32.c: Likewise.
	* linuxdev/drivers/net/rtl8139.c: Likewise.
	* linuxdev/drivers/net/smc-ultra32.c: Likewise.
	* linuxdev/drivers/net/smc9194.c: Likewise.
	* linuxdev/drivers/net/smc9194.h: Likewise.
	* linuxdev/drivers/net/tlan.c: Likewise.
	* linuxdev/drivers/net/tlan.h: Likewise.
	* linuxdev/drivers/net/wavelan.p.h: Likewise.
	* linuxdev/drivers/net/yellowfin.c: Likewise.
	* linuxdev/drivers/scsi/FlashPoint.c: Likewise.
	* linuxdev/drivers/scsi/NCR5380.c: Likewise.
	* linuxdev/drivers/scsi/NCR5380.h: Likewise.
	* linuxdev/drivers/scsi/aic7xxx/scsi_message.h: Likewise.
	* linuxdev/drivers/scsi/aic7xxx/sequencer.h: Likewise.
	* linuxdev/drivers/scsi/aic7xxx_proc.c: Likewise.
	* linuxdev/drivers/scsi/dc390.h: Likewise.
	* linuxdev/drivers/scsi/dc390w.h: Likewise.
	* linuxdev/drivers/scsi/dtc.c: Likewise.
	* linuxdev/drivers/scsi/dtc.h: Likewise.
	* linuxdev/drivers/scsi/eata_dma_proc.c: Likewise.
	* linuxdev/drivers/scsi/eata_pio_proc.c: Likewise.
	* linuxdev/drivers/scsi/gdth.c: Likewise.
	* linuxdev/drivers/scsi/gdth.h: Likewise.
	* linuxdev/drivers/scsi/gdth_ioctl.h: Likewise.
	* linuxdev/drivers/scsi/gdth_proc.c: Likewise.
	* linuxdev/drivers/scsi/gdth_proc.h: Likewise.
	* linuxdev/drivers/scsi/ncr53c8xx.c: Likewise.
	* linuxdev/drivers/scsi/ncr53c8xx.h: Likewise.
	* linuxdev/drivers/scsi/ppa.c: Likewise.
	* linuxdev/drivers/scsi/ppa.h: Likewise.
	* linuxdev/drivers/scsi/qlogicfas.c: Likewise.
	* linuxdev/drivers/scsi/qlogicfas.h: Likewise.
	* linuxdev/drivers/scsi/qlogicisp.c: Likewise.
	* linuxdev/drivers/scsi/qlogicisp.h: Likewise.
	* linuxdev/drivers/scsi/qlogicisp_asm.c: Likewise.
	* linuxdev/drivers/scsi/scripts.h: Likewise.
	* linuxdev/drivers/scsi/scsiio.c: Likewise.
	* linuxdev/drivers/scsi/scsiiom.c: Likewise.
	* linuxdev/drivers/scsi/tmscsim.c: Likewise.
	* linuxdev/drivers/scsi/tmscsim.h: Likewise.
	* linuxdev/drivers/scsi/tmscsiw.c: Likewise.
	* linuxdev/drivers/scsi/tmscsiw.h: Likewise.
	* linuxdev/include/asm-i386/atomic.h: Likewise.
	* linuxdev/include/asm-i386/checksum.h: Likewise.
	* linuxdev/include/asm-i386/ioctls.h: Likewise.
	* linuxdev/include/asm-i386/math_emu.h: Likewise.
	* linuxdev/include/asm-i386/posix_types.h: Likewise.
	* linuxdev/include/asm-i386/semaphore.h: Likewise.
	* linuxdev/include/asm-i386/sockios.h: Likewise.
	* linuxdev/include/asm-i386/string-486.h: Likewise.
	* linuxdev/include/asm-i386/termbits.h: Likewise.
	* linuxdev/include/asm-i386/unaligned.h: Likewise.
	* linuxdev/include/asm-i386/vm86.h: Likewise.
	* linuxdev/include/linux/affs_hardblocks.h: Likewise.
	* linuxdev/include/linux/atalk.h: Likewise.
	* linuxdev/include/linux/ax25.h: Likewise.
	* linuxdev/include/linux/compile.h: Likewise.
	* linuxdev/include/linux/ctype.h: Likewise.
	* linuxdev/include/linux/fddidevice.h: Likewise.
	* linuxdev/include/linux/icmp.h: Likewise.
	* linuxdev/include/linux/if_fddi.h: Likewise.
	* linuxdev/include/linux/ipx.h: Likewise.
	* linuxdev/include/linux/md.h: Likewise.
	* linuxdev/include/linux/netrom.h: Likewise.
	* linuxdev/include/linux/posix_types.h: Likewise.
	* linuxdev/include/linux/random.h: Likewise.
	* linuxdev/include/linux/ucdrom.h: Likewise.
	* linuxdev/include/linux/udp.h: Likewise.
	* linuxdev/include/linux/wireless.h: Likewise.
	* linuxdev/include/net/br.h: Likewise.
	* linuxdev/include/net/gc.h: Likewise.
	* linuxdev/include/net/ip_masq.h: Likewise.
	* linuxdev/include/net/p8022tr.h: Likewise.
	* linuxdev/include/net/p8022trcall.h: Likewise.
	* linuxdev/include/net/rose.h: Likewise.
	* linuxdev/include/net/rosecall.h: Likewise.
	* linuxdev/include/net/slhc_vj.h: Likewise.
	* linuxdev/include/net/spx.h: Likewise.
	* linuxdev/include/scsi/scsi.h: Likewise.
	* linuxdev/include/scsi/scsi_ioctl.h: Likewise.
	* linuxdev/include/scsi/scsicam.h: Likewise.

1998-11-06  OKUJI Yoshinori  <okuji@kuicr.kyoto-u.ac.jp>

	* i386/i386at/gpl/linux: Moved to ...
	* linuxdev: ... here.
	* i386/Makefrag: Linux drivers specific code moved to ...
	* linuxdev/Makefrag: ... here.
	* i386/Files: Recreated.
	* i386/Subdirs: Likewise.
	* linuxdev/drivers: New directory.
	* linuxdev/arch: Likewise.
	* linuxdev/arch/i386: Likewise.
	* linuxdev/{block,scsi,net,pci}: Moved to ...
	* linuxdev/drivers/{block,scsi,net,pci}: ... here.
	* i386/{Drivers.in,device-drivers.h.in,driverlist.in}: Moved to ...
	* linuxdev/{Drivers.in,device-drivers.h.in,driverlist.in}: ... here.
	* linuxdev/{linux_emul.h,linux_*.c}: Moved to ...
	* linuxdev/arch/i386/{linux_emul.h,linux_*.c}: ... here.
	* linuxdev/arch/i386/linux_block.c: Include <linux_emul.h>, instead
	of <i386at/gpl/linux/linux_emul.h>.
	* linuxdev/arch/i386/linux_init.c: Likewise.
	* linuxdev/arch/i386/linux_kmem.c: Likewise.
	* linuxdev/arch/i386/linux_misc.c: Likewise.
	* linuxdev/arch/i386/linux_net.c: Likewise.
	* linuxdev/arch/i386/linux_sched.c: Likewise.
	* device/ds_routines.c: Include <linuxdev/device-drivers.h>, instead
	of <i386/device-drivers.h>.
	* linuxdev/arch/i386/linux_init.c: Likewise.
	* linuxdev/include/linux/autoconf.h: Likewise.
	* Makefile.in: Include $(srcdir)/linuxdev/Makefrag.
	* linuxdev/Drivers.in (AC_INIT): Use include/linux/autoconf.h,
	instead of i386/i386asm.sym.

1998-10-28  Roland McGrath  <roland@baalperazim.frob.com>

	* include/mach/multiboot.h: Contents were doubled.

1998-10-24  Roland McGrath  <roland@baalperazim.frob.com>

	* Makefile.in (mach_machine): Don't depend on config.status, since it
	is always newer than the symlink target.

	* i386/Makefrag ($(systype)/device-drivers.h): Depend on
	$(systype)/driverlist, and have no commands.

	* configure.in (--enable-kdb): Fix help text; handle --disable-kdb.
	Remove BUILD_CC checks and lex/yacc checks (which were for mig).
	(installed_clib): Remove these checks.
	(LD, NM, MIG): Use AC_CHECK_TOOL for these.

	* Makefile.in (all, clean, mostlyclean, install, dist,
	%_interface.h rule, all *mig* rules): Remove all commands, deps,
	and rules related to mig, which is now in a separate distribution.

	* Makefile.in (before-compile): Add mach/machine.
	(mach/machine, mach_machine): New rules to make symlink so
	#include <mach/machine/foo.h> works.

	* Makefile.in (NM): New variable, substituted by configure.
	(check-clib-routines): Use $(NM) instead of literal "nm".
	Fix awk script to grok __ defns and weak defns of desired symbols.
	(clib-routines.o): Use $(CC) -r -nostartfiles -nostdlib -static
	instead of $(LD) -r.  Use -lc instead of $(installed-clib).
	(installed-clib): Variable removed.

	* i386/Makefrag: Use -include for linux-flags, so no warning.

	* device/chario.c: Add forward decl for ttstart.

	* i386/i386/db_trace.c: Use explicit int in decl.

	* device/ds_routines.c (device_write_trap, device_writev_trap,
	ds_trap_write_done): Cast arg to zfree.

	* kern/ipc_tt.c (mach_ports_lookup): Remove unnecessary cast.

1998-10-04  Roland McGrath  <roland@baalperazim.frob.com>

	* include/mach/message.h: Use __typeof instead of typeof.

1998-09-06  Roland McGrath  <roland@baalperazim.frob.com>

	* kern/time_out.h: Include <mach/time_value.h> for time_value_t defn.

1998-07-19  Roland McGrath  <roland@baalperazim.frob.com>

	* mig: Subdirectory removed, now in separate dist.

Fri Apr 24 14:24:15 1998  Thomas Bushnell, n/BSG  <tb@mit.edu>

	* i386/i386/pcb.c (thread_setstatus): Set STATE before validating
	segment registers.  Reported by UCHIYAMA Fasushi (uch@nop.or.jp).

Fri Apr 24 13:19:40 1998  Thomas Bushnell n/BSG  <thomas@melange.gnu.org>

	* kern/debug.c (panic): Increase "seconds" in delay to 1000; machines
	are faster now.

	* i386/i386at/gpl/linux/linux_kmem.c: Increase MEM_CHUNKS to 7.

Wed Aug 20 16:05:19 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* kern/thread.h (struct thread): New member `creation_time'.
	* include/mach/thread_info.h: New member `creation_time'.
	* kern/thread.c (thread_create): Set creation time stamp.
	(thread_info) [THREAD_BASIC_INFO]: Fill in new creation time
	field.  Carefully preserve compatibility with old callers.

	* kern/task.h (struct task): New member `creation_time'.
	* include/mach/task_info.h: New member `creation_time'.
	* kern/task.c (task_create): Set creation time stamp.
	(task_info) [TASK_BASIC_INFO]: Fill in new creation time field.
	Carefully preserve compatibility with old callers.

	* kern/mach_clock.c (record_time_stamp): New function.
	* kern/time_out.h (record_time_stamp): Add prototype.

Sun Aug  3 18:25:38 1997  Shantanu Goel  <goel@cs.columbia.edu>

	* i386/i386/thread.h (struct pcb): Added new field `data' used
	by Linux driver emulation.

	* i386/i386at/gpl/linux/include/linux/blk.h (end_request):
	Revamped Mach specific code.  Don't use `errors' field in request.
	Don't call driver's request function.

	* i386/i386at/gpl/linux/include/linux/fs.h (struct buffer_head):
	Deleted old Mach-specific definition.  Use original Linux defintion.

	* i386/i386at/gpl/linux/linux_block.c:  Rewritten extensively.
	(collect_buffer_pages): Deleted.
	(alloc_buffer, free_buffer): Rewritten to use Mach page allocator.
	(getblk, __brelse): Use Mach kernel allocator.
	(check_for_error): Deleted.
	(ll_rw_block): Allocate request structure on stack.
	(rdwr_partial, rdwr_full, do_rdwr) New routines.
	(block_read, block_write): Rewritten to use new routine do_rdwr.
	(find_name): New routine.
	(read_bsd_label, read_vtoc): New routines.
	(init_partition): New routine.
	(device_open): Rewritten for modularity.  Allocate Linux block
	variables on the stack.
	(check_limit): New routine.
	(device_read, device_write): Rewritten extensively.  Map user
	pages into kernel buffer before passing to driver.  This is in
	preparation for general Linux block driver support.  Allocate
	Linux block variables on the stack.

	* i386/i386at/gpl/linux/linux_kmem.c:
	(collect_buffer_pages): Deleted.

Fri Aug  1 16:15:33 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* kern/mach_clock.c (clock_interrupt): Test correct macro to see
	if PC sampling is configured: MACH_PCSAMPLE, not MACH_SAMPLE.

	* i386/i386/locore.S (discover_x86_cpu_type): Comment out routine
	for now.
	* i386/i386at/model_dep.c (c_boot_entry): Comment out use of
	discover_x86_cpu_type for now.

	* i386/include/mach/i386/eflags.h (EFL_AC, EFL_ID): New bits.

	* i386/i386/locore.S (discover_x86_cpu_type): Use correct opcode
	for right shift.  Use ENTRY macro correctly.

Mon Jul 28 17:01:19 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* COPYING: New file.
	* Makefile.in (topfiles): Add COPYING.

Mon Jul 21 14:20:39 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* kern/mach4.srv: Include <mach_pcsample.h> so the value of
	MACH_PCSAMPLE is made available for mach4.defs.

Thu Jul 10 13:51:20 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (install): Use `ln -sf' instead of `-ln -s'.
	Suggested by Marcus G. Daniels (marcus@cathcart.sysc.pdx.edu).

Thu Jun 26 13:48:31 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386/locore.S (discover_x86_cpu_type): New function.
	* i386/i386at/model_dep.c (c_boot_entry): Fill in cpu type in
	MACHINE_SLOT using new function.

	* include/mach/machine.h (CPU_TYPE_I486, CPU_TYPE_PENTIUM,
	CPU_TYPE_PENTIUMPRO, CPU_TYPE_POWERPC): New CPU types.  These
	conform to current OSF Mach values, but note that some of the
	various subtypes are different.

Mon Jun 16 12:14:17 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386/loose_ends.c (ovbcopy): Delete function.  Suggested by
	Matthew Wilcox (willy@odie.barnet.ac.uk.)

Thu Jun 12 18:08:29 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	Version 1.1.3 released.

	* version.c (version): Update to 1.1.3.

Wed Jun 11 20:16:47 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/Drivers.in: Add el3.  How did this escape notice?
	* i386/device-drivers.h.in: Add CONFIG_EL3.

Tue Jun 10 13:33:37 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	Version 1.1.2 released.

	* Makefile.in (install): Install cross-migcom as `migcom', not as
	`mig'.

	* i386/Makefrag (objfiles += $(device_drivers)): Sort
	$(device_drivers) before adding to objfiles in order to remove
	duplicates.

Mon Jun  9 22:14:09 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/Drivers.in: Fix typos apt.o -> atp.o; 3c403.o -> 3c503.o.

	* Drivers.macros (AC_DRIVER): Test the class selected flag
	correctly.

Mon May 26 14:33:19 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* version.c (version): Update to version 1.1.2.

Fri May 23 10:08:48 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* kern/thread.c (thread_info): Set flags word correctly;
	TH_FLAGS_SWAPPED and TH_FLAGS_IDLE are not exclusive.

	* Makefile.in (topfiles): Add aclocal.m4.
	Reported by Marcus G. Daniels (marcus@cathcart.sysc.pdx.edu).

Mon May 12 11:25:38 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	Version 1.1.1 released.

	* version.c (version): Update to version 1.1.1.

	* bogus/mach_kdb.h: Make sure MACH_KDB is always defined, to zero
	if necessary.  Bug report from Marcus Daniels
	(marcus@cathcart.sysc.pdx.edu).

Fri May  9 13:06:25 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/Files: Fix typo for _setjmp.S.
	Reflect 53c7,8xx.c -> 53c78xx.c change.

Wed May  7 15:32:08 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* version.c (version): Update to version 1.1.
	* NEWS: New file.
	* Makefile.in (topfiles): Add NEWS.

Mon May  5 11:34:01 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (enable_kdb): Use findstring instead of filter.
	Reported by Marcus Daniels (marcus@cathcart.sysc.pdx.edu).

Fri May  2 12:43:46 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (enable_kdb): New variable.
	(clib-routines): If enable_kdb, then add strstr.
	* i386/i386/_setjmp.S: New file, from UK22 libmach.
	* i386/Files: Add i386/i386/_setjmp.S.
	* i386/Makefrag (objfiles): Add _setjmp.o if enable_kdb.

1997-04-30  Marcus G. Daniels  <marcus@cathcart.sysc.pdx.edu>

	* Makefile.in (clib-routines): Add htons not because it is necessary,
	but because libc5 systems will bring it in.
	(check-clib-routines): Tolerate extra weak symbols.

Wed Apr 30 14:12:12 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in: Delete duplicate rule for cross-mig.

Mon Apr 28 12:09:53 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (check): New target.  Reported by
	xtest@postman.epa.go.jp.

	* i386/Drivers.in (ncr53c7xx): Change file name to 53c78xx.o.
	* i386/i386at/gpl/linux/scsi/53c7,8xx.c: Moved to ...
	* i386/i386at/gpl/linux/scsi/53c78xx.c: ... here.
	* i386/Makefrag (linux-scsi-files): Change file name here too.
	Reported by xtest@postman.epa.go.jp.

Wed Apr 23 14:35:44 1997  Miles Bader  <miles@gnu.ai.mit.edu>

	* ipc/ipc_entry.c [MACH_KDB]: Add include of <kern/task.h>.

Wed Apr 23 13:21:23 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* configure.in (BUILD_CC): Use AC_CHECK_PROGS, not AC_CHECK_PROG,
	since we are checking multiple names.

	* configure.in (kdb): New --enable option.
	* Makefile.in (DEFINES): Add @DEFS@.
	* bogus/mach_kdb.h: Make this file zero length; we get MACH_KDB
	from configure now.

	* Makefile.in (clean, distclean, mostlyclean, maintainter-clean):
	New targets.
	(all-archs-configures): New variable.
	(MIG): Change to ./local-mig.
	(./local-mig): Change to build this instead of ./mig
	(check-clib-routines): Use nm -g in case there are local symbols.
	Suggested by Matthew Wilcox (willy@odie.barnet.ac.uk).

Fri Apr 18 15:25:10 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* configure.in: Add AC_PREREQ for version 2.12.
	* i386/Drivers.in: Likewise.

Wed Apr 16 16:55:36 1997  Marcus G. Daniels  <marcus@cathcart.sysc.pdx.edu>

	* configure.in: Replace AC_PROG_CC with AC_PROG_CC_LOCAL.
	If cross compiling do Lex/Yacc checks with BUILD_CC.
        Check CC and BUILD_CC for libraries having the needed support,
	and substitute discovery in installed_clib.

	* aclocal.m4: New file.  These replacement macros are to handle
	the case where there is a cross compiler but no supporting files.

	* Makefile.in (installed-clib): Don't hardwire a Hurd libcrt.a.
	(cross_linkable): Only define cross-migcom variable when it will
	be possible to build it.
	(all, install): Use $(cross-migcom).
	(install): Install cross-migcom only if was to be built.
	(mkinstalldirs): Add $(bindir), $(includedir)/mach/exec
	(cross-lexxer.o lexxer.o): lexxer.o needs cpu.h.
	(./cross-migcom): Prevent dependency generation for cross-* MiG files
	unless they can actually be built.

Thu Apr 17 15:55:40 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* kern/exception.c (exception_no_server): Comment out the suspend
	code; it's useful for special case debugging, but causes problems
	in general.

Wed Apr 16 12:52:25 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (cross-lexxer.o lexxer.o): Add pump-priming
	dependency on cpu.h.  Reported by Marcus G. Daniels
	(marcus@cathcart.sysc.pdx.edu).

	* configure.in: Fail if configure target is not for GNU os.

	* i386/Drivers.in (com): Delete option.  It's required by
	kd_mouse.c.
	* i386/Makefrag (i386at-files): Add com.c.
	(driver-files): Delete variable.
	* i386/bogus/com.h: Revert change of March 10.
	* i386/device-drivers.h.in (CONFIG_MACH_COM): Delete option.
	Bug report from Marcus G. Daniels (marcus@cathcart.sysc.pdx.edu).

	* Makefile.in (./cross-mig): New rule.
	(mkinstalldirs): Add $(libexecdir).
	* configure.in: Recognize i686.
	Reported by Marcus G. Daniels (marcus@cathcart.sysc.pdx.edu).

Mon Apr 14 11:50:45 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Released version 1.0.

	* kern/exception.c (exception_no_server): Try and suspend the
	failing thread before killing the task.  Then a debugger can be
	used.

	* i386/Makefrag: Add rebuilding rules for configure subscript.

	* i386/Makefrag: Fix up copyright notice.
	* i386/Drivers.in: Likewise.
	* Makefile.in: Likewise.
	* Drivers.macros: Likewise.
	* configure.in: Likewise.

	* include/sys/time.h: New file, from include/mach/sa/sys/time.h.
	* include/sys/reboot.h: New file, from include/mach/sa/sys/reboot.h.
	* include/sys/ioctl.h: New file, from include/mach/sa/sys/ioctl.h.
	* include/alloca.h: New file, from include/mach/sa/alloca.h.
	* Makefile.in (other-sys-headers): Add time.h, ioctl.h, and reboot.h.
	(other-mach-headers): New variable.
	(mach-exec-headers): New variable.
	(other-headers): New variable.
	(installed-headers): Add mach-exec-headers.
	(dist): Distribute other-mach-headers, other-sys-headers,
	mach-exec-headers, and other-headers.
	(device-files): Add device.srv.

	* Makefile.in (check-clib-routines): Use more efficient rule.

Fri Apr 11 15:18:09 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (dist): Repair rule.
	(other-sys-headers): New variable.
	(dist): Install $(other-sys-headers).
	(INCLUDES): Remove -I$(srcdir)/include/mach/sa.
	(rules for mig-related .d files): Include MiG-specific -I flags.
	(mach-headers): Add inline.h.
	* include/sys/types.h: New file, from include/mach/sa/sys/types.h.

Mon Mar 24 16:23:21 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* version.c (version): Make that 1.0.  Whee.

Fri Mar 21 15:50:09 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386at/gpl/linux/scsi/aha1740.c (aha1740_test_port): Try
 	and turn on PORTADDR_ENH before checking it.

	* vm/vm_object.c (vm_object_cached_max): Increase to 200.

Thu Mar 20 12:33:06 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* Makefile.in (dist): New target.  Reorganized some vars
	describing source.
	* i386/Subdirs: New file.
	* i386/Files: New file.

	* version.c (version): Push back to 0.1.

	* Makefile.in (cross_compiling, bindir, libexecdir): New
	variable.

	* Makefile.in (install): Depend on cross-mig and cross-migcom;
	install them.  New rules added to build mig, migcom, cross-mig,
	and cross-migcom.

	* configure.in (AC_PROG_LEX, AC_PROG_YACC): New tests.
	(BUILD_CC): New test to set these.

	* Makefile.in (%.h %_user.c): Depend on $(MIG) too.
	(%_interface.h %_server.c): Likewise.
	(MIG): Don't use @MIG@; hard code it to the one we build.
	(BUILD_CC, BUILD_CFLAGS, MIGCOM, LEX, YACC, LEXLIB): New variables.

Wed Mar 19 16:47:28 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386at/kd.c (BROKEN_KEYBOARD_RESET): Turn off this so that
	we attempt the keyboard resets.
	* i386/i386/locore.S (cpu_shutdown): Attempt to provide a more
	`robust' null_idtr.

Mon Mar 17 13:47:14 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386at/gpl/linux/scsi/hosts.c (scsi_init): Don't print out
	gratuitious obnoxiousness.
	* i386/i386at/gpl/linux/scsi/scsi.c (scsi_dev_init): Likewise.
	* i386/i386at/gpl/linux/block/triton.c (ide_init_triton):
	Likewise.
	(init_triton_dma): Likewise.
	* i386/i386at/gpl/linux/pci/pci.c (pci_init): Likewise.
	* i386/i386at/gpl/linux/pci/bios32.c (check_pcibios): Likewise.
	(pcibios_init): Likewise.
	* i386/i386at/gpl/linux/block/genhd.c (add_partition): Likewise.

	* i386/i386at/gpl/linux/net/8390.c (ei_debug): Make default value
	zero.

Wed Mar 12 14:50:46 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386at/com.c (comprobe): Turn off noisiness.

	* i386/i386at/gpl/linux/linux_block.c (check_disk_change): Don't
	print out gratuitous obnoxiousness.
	(device_open): Likewise.
	* kern/bootstrap.c (copy_bootstrap): Likewise.
	(user_bootstrap): Likewise.
	* i386/i386at/gpl/linux/block/genhd.c (msdos_partition): Likewise.
	(osf_partition): Likewise.
	(sun_partition): Likewise.
	(check_partition): Likewise.
	* i386/i386/pit.c (findspeed): Likewise.
	* vm/vm_resident.c (vm_page_bootstrap): Likewise.

Mon Mar 10 15:04:47 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/i386at/gpl/linux/linux_init.c (calibrate_delay): Don't
	print out gratuitous obnoxiousness.

	* i386/i386at/gpl/linux/linux_init.c (linux_init): Only call
	linux_net_emulation_init if CONFIG_INET.  Include
	<i386/device-drivers.h>.

	* i386/i386at/i386at_ds_routines.c: Include
	<i386/device-drivers.h>.  Don't mention linux_net_emulation_ops
	unless CONFIG_INET.

	* device/ds_routines.c (io_done_thread_continue): [i386]
 	Conditionalize free_skbuffs also on CONFIG_INET.  Include
 	<i386/device-drivers.h>.

	* i386/Drivers.in, i386/device-drivers.h.in, i386/driverlist.in:
	New files.
	* i386/Makefrag: Include i386/driverlist; don't include all device
	drivers in kernel image; instead use list from driverlist.
	* configure.in: Configure in $systype subdir too.

	* i386/i386at/gpl/linux/include/linux/autoconf.h: Damage severly
	to conform to device-drivers.h model.

	* i386/bogus/com.h: Include <i386/device-drivers.h>.
	Only turn on NCOM if CONFIG_MACH_COM is present.

Mon Mar  3 16:26:58 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* include/mach/message.h (__mach_msg, __mach_msg_trap): Add decls.

Tue Feb 25 15:42:23 1997  Thomas Bushnell, n/BSG  <thomas@gnu.ai.mit.edu>

	* i386/Makefrag (INCLUDES): Find `include' directory in new
	location.
	* Makefile (INCLUDES): Find `include' directory in new location.
	(%.symc): Find gensym.awk in new location.

	* Reorganized directories into new layout and unified mach4 and
	mach4-i386 into a single tree.


Older changes in ChangeLog.00 (for i386 directory) and ChangeLog.0 (for
all other files).
